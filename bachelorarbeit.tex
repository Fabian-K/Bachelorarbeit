% -------------------------------------------------------------------------------------
% Einlesen der .sty-Dateien
% -------------------------------------------------------------------------------------
\input{sty/se-wa-input-styles}

% -------------------------------------------------------------------------------------
% Individuelle Konfiguration des Dokumentes
% -------------------------------------------------------------------------------------
\input{wa-konfiguration}

% -------------------------------------------------------------------------------------
% Individuelle Definition von Abk\"urzungen, Symbolen und eventuell Glossareintr\"agen
% -------------------------------------------------------------------------------------
\input{wa-abkuerzungen}

%TODO Generell keine Fußnoten nutzen, sondern lieber Glossar oder im Text!

\usepackage{setspace} 

\usepackage{todonotes}

% -------------------------------------------------------------------------------------
% Anforderugnen
% -------------------------------------------------------------------------------------

\newcounter{anforderung}

\newcommand{\class}[1]{\textit{#1}}

\newcommand{\instance}[1]{\textit{#1}}

\newcommand{\method}[1]{\textit{#1}}

\newcommand{\anfl}[1]{
	\refstepcounter{anforderung}
	(A\arabic{anforderung})
	\label{anf:#1}
}

\newcommand{\anfRef}[2]{\ifthenelse {\equal{\pageref{#1}}{\thepage}}    {Anforderung \ref{#1} #2(A\ref{#1})}{Anforderung \ref{#1} #2(A\ref{#1} auf \pageref{#1})}}


\newcommand{\usecaseRef}[1]{\ifthenelse {\equal{\pageref{#1}}{\thepage}}{}{ auf \pageref{#1}}}

\newcommand{\useCaseItem}[2]{
\item[~~\textbf{#1}] #2
}


\newcommand{\loreIpsum}{Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua.}

\newcommand{\useCaseEntry}[2]{
\textbf{#1} 
\vspace*{-4mm}
\begin{addmargin}[3mm]{0cm} #2
\end{addmargin} 
}

\newcommand{\useCase}[2]{
\begin{mdframed}
{\large \textbf{Anwendungsfall #1}}
#2
\end{mdframed}

}


\renewcommand{\textfraction}{0.05}
\renewcommand{\topfraction}{0.95}
\renewcommand{\bottomfraction}{0.95}
\renewcommand{\floatpagefraction}{0.35}

\setcounter{totalnumber}{1} % maximale Anzahl Gleitobjekte pro Seite

\begin{document}

\newcommand{\version}{0.1}

% -------------------------------------------------------------------------------------
% Erzeugung des Titelblatts
% -------------------------------------------------------------------------------------
\seTitelblattZweiteProjektarbeit[
firmenlogo=images/sap-logo,
firmenlogoDeltaX=-13,
firmenlogoDeltaY=-10,
thema=Entwicklung einer Zwischenschicht für die Nutzung weiterer Anwendungen in Verbindung mit der Berechnungskomponente des Liquidity Risk Managements,
verfasser=Fabian Kajzar,
matrikelnummer=428094,
kurs=WWI\,09\,SW\,B,
firma=SAP AG,
abteilung=Application Strategic Innovation - HPA,
studiengangsleiter=Prof. Dr.-Ing. J\"org Baumgart,
wissenschaftlicherBetreuerName=Prof. Dr. Hans-Henning Pagnia,
wissenschaftlicherBetreuerEmail=hans-henning.pagnia@dhbw-mannheim.de,
wissenschaftlicherBetreuerTelefon=0621 4105-1131,
firmenbetreuerName=Jens Mett,
firmenbetreuerEmail=jens.mett@sap.com,
firmenbetreuerTelefon=06227 7-61785,
bearbeitungszeitraumVon=13. Februar 2012,
bearbeitungszeitraumBis=4. Mai 2012,
sperrvermerk=nein
]

\pagenumbering{Roman}
\setcounter{page}{0}

% -------------------------------------------------------------------------------------
% Erzeugung der Kurzfassung; Verfasser, Firma und Thema werden automatisch \"ubernommen
% -------------------------------------------------------------------------------------
\seKurzfassung{}

\glsresetall

% Beispiel f\"ur ein Kapitel, dass vor dem Einleitungskapitel kommt, z. B. ein Vorwort oder eine Danksagung
%\seKapitelVorEinleitung{Vorwort}

% -------------------------------------------------------------------------------------
% Ausgabe des Inhaltsverzeichnisses
% -------------------------------------------------------------------------------------
\seInhaltsverzeichnis[
einrueckung=ja,
gliederungsebenen=4
]

% -------------------------------------------------------------------------------------
% Ausgabe der verschiedenen Verzeichnisse
% -------------------------------------------------------------------------------------
\seVerzeichnisse[gliederungsebene=section,imInhaltsverzeichnis=ja]{abk}{sym}{abb}{tab}{prg}


% -------------------------------------------------------------------------------------
% Vorbereitung für Inhalt der Arbeit
% -------------------------------------------------------------------------------------

%TODO
%TODO
%TODO
%TODO REMOVE!
\listoftodos
%TODO REMOVE!
%TODO
%TODO
%TODO


\todo{Inhaltsverzeichniss auf 2 Seiten bringen!}


% -------------------------------------------------------------------------------------
% Inhalt der Arbeit
% -------------------------------------------------------------------------------------
\begin{onehalfspacing}

\chapter{Einleitung}
\pagenumbering{arabic}

\loreIpsum

\loreIpsum

\loreIpsum

\loreIpsum

\chapter{Grundlagen des Liquiditätsrisikomanagements} \todo{Sprechendere Überschrift finden, Grundlagen ist nicht schön}

\section{Einleitung}
\loreIpsum
\section{Liquidität}

Der Begriff der Liquidität ist weit verbreitet und im allgemeinen Sprachgebrauch festgesetzt. Allerdings ist eine eindeutige Definition des Begriffs schwierig, da Liquidität sehr vielschichtig ist, mehrere Dimensionen besitzt und die jeweilige Bedeutung von der Perspektive der Betrachtung abhängt.\footnote{\seCite{vgl.}{S.3}{Dur.11} \seCite{und}{S.13}{Bar-A.08}} Für diese Arbeit ist vor allem die betriebswirtschaftliche Sicht auf Liquidität entscheidend. Die volkswirtschaftliche Sicht wird daher nicht näher erläutert.\seFootcite{vgl.}{S.10}{Zer-A.10}

In der betriebswirtschaftlichen Sicht wird zunächst die Liquidität von Objekten von der Liquidität von Subjekten unterschieden. Die Objektliquidität ist die Fähigkeit eines Vermögensgegenstandes in Zahlungsmittel umgewandelt werden zu können.\seFootcite{vgl.}{S.10}{Moc.07} Sie hängt demnach von der Nähe des Objektes zu Geld ab. Zahlungsmittel haben die höchste Objektliquidität, Immobilien eine geringe.\seFootcite{vgl.}{S.3}{Dur.11} Die Liquidität von Subjekten bezeichnet die Fähigkeit eines Subjekts, zum Beispiel einer Bank, alle Zahlungsverpflichtungen erfüllen zu können.\footnote{\seCite{vgl.}{S.3}{Dur.11} \seCite{und}{S.11}{Zer-A.10}}

Zeitlich kann Liquidität in kurz und langfristig unterschieden werden. Bei der kurzfristigen Liquidität steht der Zahlungsaspekt im Vordergrund, meist nur auf einen Tag bezogen.\seFootcite{vgl.}{S.3f}{Dur.11} Es muss zu jeder Zeit sichergestellt werden, dass alle fälligen Zahlungen in der entsprechenden Höhe beglichen werden können. Diese Bedingung ist bei der Steuerung von Banken zu jedem Zeitpunkt streng einzuhalten. \footnote{\seCite{vgl.}{S.13}{Bar-A.08} \seCite{und}{S.12}{Zer-A.10}}. Synonym werden auch die Begriffe operative Liquidität sowie dispositive Liquidität verwendet.\seFootcite{vgl.}{S.13}{Bar-A.08}

Die langfristige Liquidität bezeichnet die Fähigkeit langfristige Refinanzierungsmittel auf der Passiv-Seite der Bilanz aufzunehmen um dadurch die gewünschte Entwicklung auf der Aktiv-Seite der Bilanz ermöglichen zu können. Sie ist also mit den Zielen des Subjektes verknüpft.\seFootcite{vgl.}{S.4}{Dur.11} Für Banken ist dies besonders wichtig, da es einen entscheidenden Wettbewerbsvorteil gegenüber Mitbewerbern darstellt.\seFootcite{vgl.}{S.13}{Bar-A.08} Zwischen der kurzfristigen und langfristigen Liquidität besteht eine beidseitige Wechselwirkung -- eine schlechte kurzfristige Liquidität führt zu Problemen bei der langfristigen Liquidität.\seFootcite{vgl.}{S.15}{Bar-A.08}

Die Folgen von Liquiditätsproblemen können weitreichend sein. Probleme mit sowohl der kurzfristigen als auch der langfristigen Liquidität können zu einem Reputationsverlust führen. Gerade bei Banken hat dies schwere Auswirkungen, da Fremdkapitalgeber das Vertrauen in die Bank verlieren. Dies wiederum hat Auswirkungen auf die Passiv-Seite der Bilanz, viel Fremdkapital wird verloren gehen. Im schlimmsten Fall, wenn die Bank ihren Zahlungsverpflichtung nicht mehr nachkommen kann, muss sie Insolvenz anmelden.\footnote{\seCite{vgl.}{S.4}{Dur.11} \seCite{und}{S.65}{Rom-B.10}}

\section{Liquiditätsrisiko}
Die Finanzinstitute haben in der Vergangenheit dem Liquiditätsrisiko keine besondere Bedeutung zugewandt. Ob ein Institut das Risiko gesondert behandelt hat oder nicht, konnte frei gewählt werden. Erst im Jahr 2007, als die Grundstückspreise in den USA zusammengebrochen sind und dadurch viele Banken in Liquiditätsschwierigkeiten gekommen sind, rückte die Behandlung des Liquiditätsrisikos in den Fokus - nicht zuletzt durch die Pleite der Lehman Brothers Bank.\footnote{\seCite{vgl.}{S.5}{Bar-A.08} \seCite{und}{S.37}{Rom-A.10}}


Das Liquiditätsrisiko ist das Risiko, gegenwärtige oder zukünftige Zahlungsverpflichtungen entweder nicht, nicht vollständig oder nicht zeitgerecht nachkommen zu können.\footnote{\seCite{vgl.}{S.467f}{Hul.10} \seCite{, }{S.166f}{Rom-F.10} \seCite{und}{S.6}{Dur.11}}. Grundsätzlich ist das Liquiditätsrisiko bei allen Unternehmen vorhanden. Bei Banken ist es allerdings besonders stark ausgeprägt, da hier sowohl die Ein- als auch die Auszahlungen in hohem Maße von dem Kundenverhalten abhängen.\footnote{\seCite{vgl.}{S.90}{Zer-B.10} \seCite{und}{S.79}{Bar-D.08}}. Im weitesten Sinne wird zu dem Liquiditätsrisiko auch die Opportunitätskosten hinzugezogen, die entstehen wenn eine gewinnbringende Transaktion aufgrund fehlender Zahlungsmittel nicht durchgeführt werden kann.\seFootcite{vgl.}{S.79}{Bar-D.08}

Analog zu der Unterteilung des Liquiditätsbegriffes kann auch das Liquiditätsrisiko weiter unterteilt werden. Zunächst unterscheidet man bei dem bankenbezogenen Liquiditätsrisiko das Liquiditätsspannungsrisiko und das Zahlungsmittelbedarfsrisiko.

Das Liquiditätsanpassungsrisiko beinhaltet grundsätzlich Risiken aufgrund von Zuflüssen und kann in das Refinanzierungsrisiko und das Marktliquiditätsrisiko unterteilt werden.\seFootcite{vgl.}{S.7}{Dur.11}. Wenn im Falle eines Engpass nicht genügend Mittel beschafft werden können, oder dies nur unter erhöhten Marktpreisen erreicht werden kann, wird von dem Refinanzierungsrisiko gesprochen. Das Vertrauen der Marktteilnehmer ist hier entscheidend. Beeinflusst werden kann es vor allem durch die Veränderung des Leitzinses der Notenbank.\seFootcite{vgl.}{S.7f}{Dur.11} Das Marktliquiditätsrisiko bezieht sich auf die Geldnähe von Aktiva und bezeichnet das Risiko, einen Aktivposten nur zu hohen Transaktionskosten liquidieren zu können. Es ist nur schwer beeinflussbar, da es von dem aktuellen Angebot und der Nachfrage auf dem jeweiligen Markt abhängt.\seFootcite{vgl.}{S.9}{Dur.11}

Das Zahlungsmittelbedarfsrisiko, auch originäres Liquiditätsrisiko genannt, beruht im Gegensatz zu dem Liquiditätsspannungsrisiko auf den Abflüssen von Liquidität. Es wird hauptsächlich das Terminrisiko und das Abrufrisiko unterschieden.\footnote{\seCite{vgl.}{S.7f}{Dur.11} \seCite{und}{S.12}{Zer-A.10}} Das Terminrisiko resultiert aus verspäteten Zahlungseingängen, genauer gesagt aus außerplanmäßigen Prolongationen von Aktivgeschäften über die vereinbarte Kapitalbindungsdauer hinaus.\footnote{\seCite{vgl.}{S.12}{Poh.08} \seCite{und}{S.51}{Zer.05}}. Ein Beispiel ist die Verlängerung eines Kredites, da der Kreditnehmer die Tilgung oder die Zinsen des Kredites nicht bezahlen kann.\seFootcite{vgl.}{S.10}{Dur.11} Das Abrufrisiko beruht auf einer unerwarteten Ausnutzung von zugesagten Kreditlinien. Hier findet ein Liquiditätsabfluss in unerwarteter Höhe statt.\seFootcite{vgl.}{S.513f}{SLK.08} Der bekannteste und zugleich extremste Fall des Abrufrisikos ist eine \gls{glos:bankrun}.


\section{Liquiditätsrisikomanagement}
Das Liquiditätsrisikomanagement bei Banken hat in den letzten Jahren zunehmend an Bedeutung gewonnen. Durch die Implementierung eines Liquiditätsrisikomanagements  soll vor allem die Liquiditätssituation einer Bank jederzeit transparent dargestellt werden können. Durch die Darstellung kann wiederum die Situation überwacht und so die Zahlungsfähigkeit sichergestellt werden. Gleichzeitig können die Liquiditätskosten minimiert werden. Weitere Ziele sind die Erfüllung der Anforderungen von Ratingagenturen sowie rechtliche Anforderungen.\seFootcite{vgl.}{S.256f}{Bar-J.08} Die Steuerung der Liquiditätsrisiken sollten in die Gesamtbanksteuerung eingebunden werden - nur so kann eine gesamtheitliche Sicht gewährleistet werden.\seFootcite{vgl.}{S.20f}{Bar-A.08}

Grundsätzlich existiert zum einen die Ansicht, dass für das Management des Liquiditätsrisikos keine gesetzlichen Regelungen und Vorschriften festgelegt werden müssen. Eine Regulierung findet in der freien Marktwirtschaft automatisch statt, indem Institutionen, die ein schlechtes Liquiditätsrisikomanagement haben, gegen über Institutionen mit einem besseren Liquiditätsrisikomanagement Wettbewerbsnachteile haben. Dass es im Liquiditätsrisikomanagement allerdings doch zahlreiche rechtliche Vorschriften gibt liegt an der besonderen Situation im Bankensektor.\seFootcite{vgl.}{S.457f}{Hof-A.11}

Durch die hohen Verflechtungen und Abhängigkeiten der Banken untereinander besteht ein Systemrisiko.\seFootcite{vgl.}{S.233f}{Eve-A.08} Ein starker Mittelabfluss bei einer einzelnen Bank, der bei dieser Bank zu Liquiditätsproblemen führt und schließlich zur Insolvenz kann dazu führen, dass das Vertrauen der Banken untereinander und damit der \gls{glos:interbankenhandel} zusammenbricht. Dadurch fehlt allen Banken eine Liquiditätsquelle -- die Probleme einer einzelnen Bank haben den gesamten Bankensektor erreicht.\seFootcite{vgl.}{S.265}{Hul.10}

Um dieses Systemrisiko zu begrenzen existieren einige gesetzliche Vorgaben. Hier ist als Ursprung der erste Basler Akkord zu nennen. Er wurde 1988 von der Aufsichtsbehörde der G-10 Staaten in Verbindung mit der \gls{biz} erlassen. Der erste Basler Akkord wird allgemein hin als Basel I bezeichnet. In Basel I ist festgelegt, dass Banken Eigenkapital in Abhängigkeit zu ihren Risiken hinterlegen müssen.\footnote{\seCite{vgl.}{S.291}{Hul.10} \seCite{und}{S.1f}{Hue.04}} In Deutschland spielen die \gls{MaRisk} und die \gls{LiqV} eine wichtige Rolle.

In den \gls{MaRisk} sind Anforderungen an das Liquiditätsrisikomanagement in Banken festgelegt und damit die Vorgaben von Basel II, dem Nachfolger von Basel I, in deutschem Recht umgesetzt.\seFootcite{vgl.}{S.52f und 58}{Bar-C.08} In der \gls{LiqV} ist vor allem die Öffnungsklausel wichtig. Durch die Öffnungsklausel ist es Banken möglich, interne Methoden zu verwenden, um rechtliche Vorgaben abzudecken. Dadurch kann das Liquiditätsrisiko über die rechtlichen Vorgaben hinaus gesteuert werden und die Integration in die Gesamtbanksteuerung wird erleichtert.\footnote{\seCite{vgl.}{S.53}{Bar-C.08} \seCite{und}{S.194}{Bar-H.08}}

Die gesetzlichen Vorschriften können in zwei Dimensionen eingeteilt werden. Die erste Dimension ist die Unterscheidung in qualitative und quantitative Bedingungen. Die qualitativen Bedingungen legen Anforderungen an die Qualität von Strukturen und Prozessen fest, bei den quantitativen Bedingungen geht es um wertmäßige Einhaltung von bestimmten Kennzahlen. Die zweite Dimension unterteilt die Regelungen in nationale und internationale Regelungen. Die genannten Vorschriften sind in \vref{table:einordnung} entsprechend eingeordnet.\seFootcite{vgl.}{S.15}{Dur.11}

{
\setlength{\extrarowheight}{2pt}
\begin{table}[htbp]
\centering
\begin{tabular}{| l | >{\centering\arraybackslash} m{4cm} | >{\centering\arraybackslash} m{4cm} |}
\cline{2-3}
\multicolumn{1}{l|}{}	& International & National 		\\	\hline
Qualitativ 				& - 			& \gls{LiqV}	\\	\hline
Quantitativ 			& Basel II 		& \gls{MaRisk}	\\	\hline
\end{tabular} 
\caption{Einordnung einiger Liquiditätsvorschriften \label{table:einordnung}}
\end{table}
}

Die Maßnahmen, die mit Hilfe des Liquiditätsrisikomanagements getroffen werden sind meist entweder ursachen- oder wirkungsbezogen. Ursachenbezogene Maßnahmen zielen darauf ab, das Risiko bereits vor dem Eintritt zu begrenzen. Wirkungsbezogene Maßnahmen haben das Ziel, die Auswirkungen eines Risikos, nachdem es eingetreten ist, zu vermindern. Ein Beispiel für eine ursachenbezogene Maßnahme bei Banken ist die Risikominderung, in dem die Höhe von möglichen Liquiditätsrisiken im Voraus über Frühwarnsysteme begrenzt wird. Eine wirkungsbezogene Maßnahme ist der Risikotransfer, bei dem die Folgen über eine Versicherung auf andere abgewälzt werden.\seFootcite{vgl.}{S.85ff}{Dur.11}

\todo{Abkürzung LCR auch als Glossareintrag umsetzen}
In der aktuellen Entwicklung spielt Basel III eine wichtige Rolle. Durch Basel III soll das Liquiditätsrisikomanagement weiter homogenisiert werden. Ein zentraler Punkt ist die Einführung von zwei Liquiditätskennzahlen, \gls{glos:lcr} und \gls{glos:nsfr}, die schrittweise eingeführt werden. Die \gls{glos:lcr} soll verhindern, dass kurzfristige Probleme auf dem Geldmarkt auf Banken übergreifen und damit das Systemrisiko eindämmen. Banken müssen ausreichend Vermögenspositionen besitzen, die selbst in einer Stresssituation liquidiert werden können. Damit müssen unerwartete Liquiditätsabflüsse in einem Zeitraum von 30 Tagen abgefangen werden können. Der \gls{glos:lcr} wird ab 2015 für alle Kreditinstitute binden eingeführt.\seFootcite{vgl.}{S.56}{Hof-B.11}

Neben dem \gls{glos:lcr} existiert mit dem \gls{glos:nsfr} eine weitere wichtige Kennzahl im Rahmen von Basel III. Er bezieht sich auf das Verhältnis von mittel und langfristigen Aktivpositionen im Vergleich zu langfristigen Refinanzierungsquellen. Mit dem \gls{glos:nsfr} soll erreicht werden, dass Banken längerfristige Refinanzierungsquellen nutzen und sich nicht nur auf kurzfristige Quellen beschränken. Die Vorgaben bezüglich der \gls{glos:nsfr} müssen erstmals ab 2018 eingehalten werden.\seFootcite{vgl.}{S.56f}{Hof-B.11}

\section{Zusammenfassung}
\loreIpsum

\chapter{SAP LRM und BusinessObjects Xcelsius} \todo{Anderer Titel!}
\section{Einleitung}
\loreIpsum
\section{SAP LRM}

\subsection{Funktionen}
Das SAP LRM ist eine Anwendung für Banken, um Liquiditätsrisiken managen zu können. Es unterstützt den kompletten Risikomanagementprozess von der Identifikation der Risiken, der genaueren Analyse eines Risikos über die Findung von Maßnahmen zur Behandlung des Risikos bis zur Berichtserstellung und Überwachung. Der Schwerpunkt liegt dabei besonders auf dem letzten Teil, der Berichtserstellung und Überwachung. Neben einer Weboberfläche wird der Zugriff auf die Informationen des SAP LRM auch über mobile Endgeräte, wie zum Beispiel dem Apple iPad, durch die Bereitstellung von entsprechenden Applikationen ermöglicht.\seFootcite{vgl.}{S.10 und S.23}{LRM-PPT.12}

\todo{HANA Abkürzung klären}
Durch den Einsatz der LRM Lösung können Banken rechtliche Anforderungen, wie zum Beispiel die Einhaltung des \gls{glos:lcr} und des \gls{glos:nsfr} im Rahmen von Basel III sicherstellen. Zusätzlich können durch die Bereitstellung einer Berechnungskomponente eigene Kennzahlen zur Steuerung und Überwachung der Bank definiert und umgesetzt werden. Durch den Einsatz von der \gls{HANA} ist es möglich, eine zahlungsstromorientierte Herangehensweise trotz der großen Datenmengen zu ermöglichen und gleichzeitig in Echtzeit\footnote{Die Echtzeitanforderung wurde in diesem Kontext auf eine Reaktionszeit von einer Sekunde festgelegt.} mit den Daten zu arbeiten. Im Bereich des Liquiditätsrisikomanagement müssen mehrere Geschäftsbereiche involviert werden. Deshalb bietet das SAP LRM kollaborative Möglichkeiten um dies zu unterstützen.\seFootcite{vgl.}{S.9 und S.17f}{LRM-PPT.12}

Als Datenquelle für die Zahlungsströme werden neben SAP-Systemen, meist ein \gls{ERP}-System, auch nicht-SAP-Systeme unterstützt. Somit kann sichergestellt werden, dass Analysen auf einer vollständigen Datenbasis durchgeführt werden. Für die Analysen können verschiedene Szenarien simuliert werden. Bei jedem Szenario werden dabei Annahmen über die zukünftige finanzielle Entwicklung getroffen. Meist handelt es sich dabei um die Herauf- oder Herabstufung der Kreditwürdigkeit von Kunden, die Entwicklung von Aktienkursen, das Verhalten der Marktteilnehmer oder Währungskursschwankungen. Durch diesen Spielraum ist es möglich, ein genaues Bild über die Liquiditätsrisiken der Bank zu erhalten.\seFootcite{vgl.}{S.18 und S.45}{LRM-PPT.12}


\subsection{Architektur}

\subsubsection{NGAP}
Die \gls{NGAP} stellt die technologische Grundlage für das SAP LRM dar. Sie ist eine Plattform für in \gls{glo:abap} geschriebene Unternehmensanwendungen und soll eine moderne Alternative zu dem \gls{NetWeaver} bieten. Dieser stellte bisher die Grundlage für fast alle Anwendungen der SAP dar. Entscheidende Merkmale ist die Nutzung von \gls{HANA} im \gls{glo:abap}-Umfeld, eine Verschlankung des gesamten Technologiestacks, die Einführung einer auf Eclipse\footnote{Eclipse IDE - http://www.eclipse.org/} basierenden Entwicklungsumgebung und die vereinfachte Bereitstellung von \gls{glos:rest}-basierenden Webservices.\seFootcite{vgl.}{S.1f}{NGAP-FS}

Der \gls{NetWeaver} hat sich als ausgereifte und verlässliche Plattform erweisen, die sowohl einen Java- als auch einen \gls{glo:abap} Stack besitzt und in Verbindung mit vielen Betriebssystemen und Datenbanken genutzt werden kann. Durch die Unterstützung der beiden Programmiersprachen, der Betriebssysteme und der verschiedenen Datenbanken ist das Thema Kompatibilität bei der Weiterentwicklung ein entscheidendes Merkmal. Dadurch wird die Komplexität von Erweiterungen deutlich erhöht und durch die lange Entwicklungszeit des \gls{NetWeaver} sind Codeteile bis zu 20 Jahre alt.\footnote{\seCite{vgl.}{}{NGAP-V2} \seCite{und}{S.1}{NGAP-FS}}

Diese Nachteile sind der Grund für die Entwicklung der \gls{NGAP}. Die \gls{NGAP} basiert auf dem Quellcode des \gls{NetWeaver} in der Version 7.2. Die wichtigsten Veränderungen sind das Entfernen des Java-Stacks, die Verschlankung des zugrundeliegenden Kernels und des \gls{glo:abap}-Stacks. Der Kernel wurde komplett restrukturiert, weiter modularisiert und die Unterstützung auf wenige Betriebssysteme und die Datenbank von \gls{HANA} als einzige Datenbank reduziert. Durch den Wegfall der Kompatibilitätsanforderungen konnten große Teile des \gls{glo:abap}-Stacks entfernt oder vereinfacht werden.\seFootcite{vgl.}{}{NGAP-V1} Des Weiteren wurde zum ersten Mal ein durchgehendes API für die Programmierung von Anwendungen auf Basis der \gls{NGAP} eingeführt. Dadurch sind interne Änderungen an der \gls{NGAP} möglich, ohne die Anwendungen anpassen zu müssen.\seFootcite{vgl.}{}{NGAP-V2} Insgesamt konnten durch die Änderungen die Anzahl der Quellcodezeilen um 60\% reduziert werden. Dadurch ergeben sich Vorteile in der Wartung da potentiell weniger Fehler enthalten sein können.\seFootcite{vgl.}{S.2}{NGAP-FS}

Zusammengefasst bietet die \gls{NGAP} eine einfacherer Möglichkeit für die Entwicklung von Anwendungen in Verbindung von aktuellen Innovationen wie zum Beispiel \gls{HANA} oder dem Anschluss von mobilen Clients auf Basis von \gls{glos:rest}-Webservices.

\subsubsection{HANA}
Die \gls{HANA} ist ein Produkt der SAP und besteht aus Softwarekomponenten, die in Kombination mit zertifizierter Hardware verkauft werden. Es ist die Reaktion auf den Bedarf nach der schnellen Auswertung von großen Datenmengen. Dies soll durch die Ausnutzung der Leistungssteigerung von modernen Computern erreicht werden. Hier ist zum einen die Entwicklung von Einkernprozessoren zu Mehrkernprozessoren zu nennen und zum anderen die Verfügbarkeit von schnellem Hauptspeicher in der benötigten Größe zu vertretbaren Kosten.\seFootcite{vgl.}{S.14f}{PZ.11} Das Ziel von \gls{HANA} ist es aktuelle operationale Daten in Verbindung mit bestehenden historischen Daten in Echtzeit zu Analysieren und somit Informationen zu gewinnen.\seFootcite{vgl.}{}{HANA.12}

Der Kern der \gls{HANA} bildet dabei ein hauptspeicherbasiertes \gls{DBMS}. Dabei werden alle Daten nicht wie bei traditionellen \gls{DBMS} auf Festplatten gespeichert, sondern im Hauptspeicher gehalten um höhere Zugriffsgeschwindigkeiten zu erreichen.\seFootcite{vgl.}{S.12f}{Kle.10} Außerdem ist neben der zeilenbasierten Organisation der Daten im Speicher auch die spaltenbasierte Organisation möglich. Der Unterschied in \vref{fig:vergleich_spalte_zeile} zu sehen. 

\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=15cm]{images/in-memory-row-column.png}
\caption{...\label{fig:vergleich_spalte_zeile}}
\end{figure}
\todo{Einbindung checken und Titel festlegen}

Die zeilenbasierte Organisation ist von Vorteil, wenn auf einzelne Datensätze komplett zugegriffen werden soll, die spaltenbasierte Organisation ist bei Tabellen mit einer hohen Anzahl an Spalten und bei spaltenbasierten Operationen wie der Aggregation oder der Suche überlegen. Durch die Unterstützung von beiden Organisationsformen kann die jeweils beste Form gewählt werden.\seFootcite{vgl.}{S.13f}{Kle.10}

Veränderungen in einem Datensatz einer Tabelle können auf Wunsch nicht in dem Eintrag der Tabelle direkt geändert, sondern nur die Differenzen an die Tabelle angefügt werden. Dadurch bleibt die Information, wie sich der Datensatz im Laufe der Zeit verändert hat, erhalten und kann in späteren Auswertungen als weitere Information hinzugezogen werden. Zusätzlich ist das Anfügen der Veränderung schneller durchzuführen wie die Veränderung des bestehenden Datensatzes.\seFootcite{vgl.}{S.109f}{PZ.11}

Zu den genannten Veränderungen wird in Anwendungen, die auf Basis von \gls{HANA} entwickelt werden, versucht, ein Teil der Anwendungslogik schon auf der Datenbank selbst zu berechnen.\seFootcite{vgl.}{S.155f}{PZ.11} Erreicht wird dies durch die Erweiterung der Abfragesprache \gls{SQL} zu \gls{glos:sqlscript}. Mit \gls{glos:sqlscript} ist es unter anderem durch das Hinzufügen von Datentypen, Prozeduren und Operationen möglich, Anwendungslogik abzubilden. Diese Berechnungen können von der Datenbank durch Parallelisierung sehr schnell durchgeführt werden.\seFootcite{vgl.}{S.9f}{SQLScript.11} Als Resultat kann die Datenübertragung zwischen dem \gls{DBMS} und der Anwendung verringert werden. Es muss nur noch das Ergebnis und nicht die Datensätze, auf denen das Ergebnis basiert, übertragen werden. Zusätzlich wird die Komplexität der Anwendung verringert, da ein Teil der Logik von dem \gls{DBMS} übernommen wird.

\subsubsection{Oberon}
Als Oberflächentechnologie wird für das SAP LRM das Oberon Framework genutzt. Es wurde ursprünglich als Oberfläche für \gls{glos:bydesign} entwickelt und wird jetzt auch für weitere Anwendungen unter anderem für Anwendungen, die auf HANA und NGAP basieren, verwendet.\seFootcite{vgl.}{}{Oberon-A} Ein Beispiel eines mit dem Oberon Framework umgesetzte Oberfläche ist in \vref{fig:oberon} zu sehen.

\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=15cm]{images/OberonUI.png}
\caption{Darstellung eines Zahlungsstrom-Eintrags mit dem Oberon-Framework\label{fig:oberon}}
\end{figure}

Oberflächen werden mit dem Oberen Framework mit der Programmiersprache C\# und Microsoft Silverlight\footnote{Microsoft Silverlight - http://www.microsoft.com/silverlight/} entwickelt. Silverlight ist eine Technologie von Microsoft, die als Plugin für verschiedene moderne Browser verfügbar ist und die Entwicklung von \gls{glos:ria} unterstützt. Die \gls{glos:ria} stellt dabei die erste Schicht der drei Schichtenarchitektur von Anwendungen dar. Die weiteren Schichten, die Anwendungslogik und die Persistenz, werden von NGAP und HANA übernommen.\seFootcite{vgl.}{}{Oberon-A}

Das Oberon Framework ist als Standardframework ausgelegt und versucht, möglichst viele Anforderungen abzudecken, um dadurch in vielen Produkten verwendet werden zu können. Allerdings ist es sehr Wahrscheinlich, dass spezielle Anforderungen eines bestimmten Bereichs nicht mit dem Oberon Framework abgedeckt werden können. In diesem Fall müssen eigene Lösungen für die Anforderungen entwickelt werden.\seFootcite{vgl.}{}{Oberon-A}

\subsection{Berechnungskomponente}
\label{sec:berechnungskomponente}
Die Berechnungskomponente stellt den wichtigsten Teil des SAP LRM dar. Mit ihr werden alle Berechnungen im Umfeld des Liquiditätsrisikomanagements zentral durchgeführt. Die Berechnung findet auf Basis von Liquiditätsgruppen statt. Mit Hilfe von Liquiditätsgruppen werden sowohl aggregierter Zahlungsstrom als auch Kennzahlen einheitlich berechnet. Liquiditätsgruppen können in Polyhierarchien\footnote{Polyhierarchien sind hierarchische Strukturen, bei der ein Element mehrere übergeordnete Elemente haben kann.} angeordnet werden.\todo{Erklärung für POlyhiererchien inline!} Dadurch können Berechnungen modular aufgebaut, wiederverwendet und einfach nachvollzogen werden. Das Abbilden von komplexen Berechnungsvorschriften wird erleichtert.\seFootcite{vgl.}{S.38}{LRM-PPT.12} Eine Hierarchie ist in \vref{fig:liquigruppe_hierarchie} zu sehen.

\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=10cm]{images/liquigruppe_hierarchie.PNG}
\caption{...\label{fig:liquigruppe_hierarchie}}
\end{figure}
\todo{Einbindung checken und Titel festlegen}

Es existieren zwei Arten von Liquiditätsgruppen: Die Datenbankselektion und die Berechnung. Die Datenbankselektion bildet immer den Ursprung einer Berechnung. Dabei werden einzelne Zahlungsströme nach festgelegten Selektionskriterien ausgewählt, und nach Bedingungen zusammengefasst. Selektionskriterien können zum Beispiel der hinter liegende Produkttyp des Zahlungsstroms wie zum Beispiel verzinsliches Wertpapier, oder das entsprechende Finanzrating, zum Beispiel AAA sein. Gleichzeitig findet eine Währungsumwandlung in eine einheitliche Zielwährung statt. Mehrere Zahlungsströme werden in Abhängigkeit ihrer Fälligkeit in Behältern zusammengefasst. Diese Behälter werden von dem festgelegten Fälligkeitsband definiert.\seFootcite{vgl.}{S.40}{LRM-PPT.12}

Ein Fälligkeitsband ist eine spezielle Einteilung der Zeitachse. Der Grund für die Einführung von Fälligkeitsbändern liegt in der späteren Auswertung der berechneten Werte. Dabei ist für naheliegende Zeiträume, zum Beispiel die nächste Woche, der entsprechende Wert an jedem einzelnen Tag entscheidend. Für den weiteren Horizont, zum Beispiel den Zeitraum zwischen drei und fünf Jahren, ist nicht jeder einzelne Tag  entscheidend, es reichen aggregierte Werte, zum Beispiel nach Monat oder Jahr. Somit kann in einer Auswertung sowohl die aktuelle Situation begutachtet werden, als auch die langfristige Auswirkungen ohne, dass die Auswertung unübersichtlich wird. Jeder Eintrag entspricht dabei einem Behälter. Die Anzahl und Größe der Behälter ist in einem Fälligkeitsband definiert.\seFootcite{vgl.}{S.44}{LRM-PPT.12} Ein Beispiel für ein Fälligkeitsband ist in \vref{fig:laufzeitband} dargestellt.

\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=15cm]{images/laufzeitband.jpg}
\caption{...\label{fig:laufzeitband}}
\end{figure}
\todo{Titel festlegen}

Neben der Datenbankselektion existiert die Liquiditätsgruppenart Berechnung. Dabei werden aggregierte Zahlungsströme nach verschiedenen Regeln verrechnet. Zur Verfügung stehende unter anderem Addition, Subtraktion, Multiplikation und Division. 

Generell hat eine Liquiditätsgruppe genau einen Output-Parameter, eine Berechnungsregel und kann zusätzlich mehrere Input-Parameter besitzen. Die Berechnung innerhalb einer Liquiditätsgruppe kann von szenarioabhängigen Variablen beeinflusst werden. Damit lassen sich zum Beispiel erwartete Kreditausfälle simulieren. Über diese Variablen werden die Szenarien umgesetzt. Mehrere Variablenausprägungen legen ein Szenario fest.\seFootcite{vgl.}{S.39 und S.45}{LRM-PPT.12}

\label{sec:berechnungskomponente:parameter}
Zur Laufzeit wird die Berechnungskomponente mit vier Parametern aufgerufen. In dem ersten Parameter werden eine oder mehrere Liquiditätsgruppen festgelegt, von denen später das Ergebnis zurückgeliefert wird. Ein weiterer Parameter legt den Stichtag fest, nach dem die Zahlungsströme ausgewählt werden. Jede Berechnung wird immer auf Basis von einem Fälligkeitsband durchgeführt, welches die Behälter festlegt, in dem die Ergebnisse zusammengefasst werden. Schließlich wird noch eine Zielwährung festgelegt, in die alle Zahlungsströme umgerechnet werden.

Das Resultat der Berechnung ist jeweils der Output der festgelegten Liquiditätsgruppen. Zur Berechnung der Gruppen müssen in der Regel im Hintergrund weitere Liquiditätsgruppen berechnet werden, die allerdings nicht als Ergebnis zurückgeliefert werden. Während einer Berechnung werden Ergebnisse von Gruppen, die schon einmal berechnet wurden, zwischengespeichert, um Rechenaufwand zu sparen. Die Gruppen, die berechnet werden müssen, können aus der Hierarchie der entsprechenden Liquiditätsgruppe abgelesen werden.\seFootcite{vgl.}{S.44 und S.47}{LRM-PPT.12}

\section{BusinessObjects Xcelsius}
\label{sec:xcelsius}
\subsection{Überblick und Funktionsumfang} \todo{Richtiger Titel?}
\gls{Xcelsius} ist ein Teil der SAP BusinessObjects-Portfolio. Dabei handelt es sich um Anwendungen, mit denen Daten in einem Unternehmen analysiert und ausgewertet werden können. \gls{Xcelsius} ist davon ein Tool zur Visualisierung von Daten durch die Erstellung von interaktiven Dashboards.

Dazu bietet es viele Möglichkeiten um Daten visualisieren und interaktiv beeinflussen zu können. Neben 20 Diagrammtypen, darunter unter anderem Linien-, Kreis-, Balken-  und Flächendiagramme, stehen Schaltflächen zur Manipulation, wie zum Beispiel Schieberegler, Optionsfelder und Drehknöpfe, zur Verfügung. Zusätzlich können Kartenelemente zur Darstellung von Geoinformationen genutzt werden und Bilder und Texte unterstützend in ein Dashboard eingebunden werden. Viele Komponenten bieten zusätzlich Einstellungsmöglichkeiten, durch die das Aussehen oder das Verhalten angepasst werden kann.\seFootcite{vgl.}{S.31f und S.229f}{Egg.09}

Die Daten, auf denen die Visualisierungen in \gls{Xcelsius} basieren, werden durch die Integration von Microsoft Excel verwaltet. Excel steht dabei in vollem Umfang zur Verfügung. Es können sowohl  Berechnungen, als auch Formatierungen mit Excel durchgeführt werden. In \gls{Xcelsius} wird Excel als Schnittstelle zwischen der Datenbeschaffung aus verschiedensten Quellen und der eigentlichen Visualisierung genutzt. Alle Daten, die visualisiert werden sollen, werden in ein Tabellenkalkulationsblatt von Excel geschrieben und von dort aus ausgelesen. Die Daten können demnach vor der Darstellung in Excel beliebig bearbeitet werden.\seFootcite{vgl.}{S.32 und S.236}{Egg.09} \todo{Tabellenkalkulationsblatt oder Tabellenblat?!}

\todo{WYSIWYG-Prinzip als Abkürzung?!}
\todo{Flex oder Adobe Flex}
Die gesamte Erstellung eines Dashboards findet nach dem „What you see is what you get“-Prinzip statt. Der Anwender sieht schon während der Erstellung, wie das Ergebnis aussieht. Durch die Verwendung von Excel und dem Umsetzen des Wysiwyg-Prinzip benötigen Nutzer meist nur eine geringe Einarbeitungszeit und die Bedienung kann als intuitiv beschrieben werden. Besondere Programmiersprachenkenntnisse sind für die Erstellung von Dashboards nicht erforderlich.\seFootcite{vgl.}{S.32 und S.239}{Egg.09}

Die mit \gls{Xcelsius} erstellten Dashboards werden mit Hilfe der Adobe Flex Technologie dargestellt. Dadurch ist kein spezieller Server oder ein \gls{DBMS} notwendig. Es wird nur das Flash-Plugin benötigt. Außerdem muss dafür für die Darstellung keine Netzwerkverbindung zu einem Server oder dem Internet vorhanden sein.  Zusätzlich können Dashboards in verschiedene Formate exportiert werden um sie so in Microsoft PowerPoint-Präsentationen oder auf Internetseiten einzubinden.\seFootcite{vgl.}{S.31f und S.230}{Egg.09}

Als Datenquellen für ein Dashboard stehen mehrere Möglichkeiten zur Verfügung. Zum einen können Daten einfach in das Excel kopiert werden.  Es ist auch möglich, ein SAP Business Warehouse System direkt anzuschließen, oder Daten über Webservices zu beziehen. Hierzu wird das \gls{XML}-Format verwendet. Außerdem existieren weitere Möglichkeiten, mit dem Dashboards zum Beispiel untereinander Daten austauschen können.\seFootcite{vgl.}{S.283f}{Egg.09}

\subsection{Bedienungskonzept}
Die Oberfläche von \gls{Xcelsius} lässt sich in vier Bereiche Aufteilen. Die Bereiche sind in \vref{fig:xcelsius_ui_aufbau} dargestellt. Der erste Bereich zeigt die Zeichenfläche, also das eigentliche Dashboard an. Auf der Zeichenfläche können Komponenten beliebig platziert werden. Alle verfügbaren Komponenten werden in dem Bereich 2 auf der linken Seite nach Kategorien geordnet dargestellt. Um eine Komponente auf der Zeichenfläche zu platzieren, wählt der Nutzer die Komponente aus und platziert sie per Drag\& Drop auf der Zeichenfläche. 

\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=15cm]{images/Xcelsius_UI_Aufbau.jpg}
\caption{... \label{fig:xcelsius_ui_aufbau}}
\end{figure}
\todo{Titel festlegen}

Viele Komponenten bieten Einstellungsmöglichkeiten an, mit denen das Verhalten und das Aussehen der Komponente festgelegt werden kann. Wird eine Komponente auf der Zeichenfläche ausgewählt, werden alle verfügbaren Eigenschaften in Bereich 3 auf der rechten Seite dargestellt. Wichtige Eigenschaften einer Komponente stellen oft die Daten dar, die die Komponenten anzeigen soll. Alle Daten werden in Bereich 4 festgelegt. Die Verbindung zwischen der Datenhalten (Microsoft Excel in Bereich 4) und der Darstellung (Zeichenfläche in Bereich 1) von \gls{Xcelsius} erfolgt durch das Referenzieren von Zellen oder Zellbereichen über die Eigenschaften einer Komponente (Bereich 3).\seFootcite{vgl.}{S.229}{Egg.09}

\todo{bessere einleitung?!}
Der generelle Ablauf des Erstellens von Dashboards soll an dem Beispiel der Absatzzahlen von Produkten in \vref{fig:xcelsius_ui_beispiel} verdeutlicht werden: Zunächst werden Daten in das Excel in einen festgelegten Bereich Eingetragen. Diese Daten können entweder fest eingegeben werden, meistens werden sie aber dynamisch über eine Datenquelle, zum Beispiel einen Webservice in den Bereich geschrieben. In dem Beispiel wurden die Absatzzahlen fest in den Zellbereich 1 eingetragen. Als nächstes können in Excel Berechnungen durchgeführt werden. In dem Beispiel wird die Summe der Absatzzahlen pro Jahr durch eine Excel-Formel berechnet. Um die Interaktivität von Dashboards zu zeigen, soll der Nutzer die Möglichkeit haben, die Auswirkungen von verschiedenen Wachstumsraten interaktiv zu sehen. Dazu werden die veränderten Absatzzahlen (Bereich 2) auf Basis der Quelldaten in Bereich 1 und den Wachstumsdaten in Bereich 3 berechnet.\seFootcite{vgl.}{S.229f}{Egg.09}

\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=15cm]{images/Xcelsius_UI_Beispiel.jpg}
\caption{....\label{fig:xcelsius_ui_beispiel}}
\end{figure}
\todo{Titel festlegen}

Schließlich werden auf der Zeichenfläche zwei Diagramme festgelegt, die ihre Daten aus Bereich 2 auslesen. Die Wachstumsraten können mit drei Drehknöpfe festgelegt werden. Die Werte der Drehknöpfe sind mit den Zellen in Bereich 3 verknüpft. Dreht der Nutzer an einem Drehknopf, wird der aktualisierte Wert in die Zelle in Bereich 3 geschrieben. Da die Datenquelle der Diagramme mit Bezug auf die Wachstumswerte berechnet werden, verändert sich dynamisch die Diagramme. Das Prinzip ist schematisch noch einmal in \vref{fig:xcelsius_ablauf_schema} dargestellt. So ist es möglich, mit einfachen Mitteln, interaktive Dashboards zu erstellen.\seFootcite{vgl.}{S.237}{Egg.09}

\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=15cm]{images/Xcelsius_UI_Ablauf.jpg}
\caption{...\label{fig:xcelsius_ablauf_schema}}
\end{figure} \todo{Titel festlegen}

\subsection{Architektur} \todo{Komplett überarbeiten!}
\gls{Xcelsius} basiert auf dem \gls{glos:netFramework} von Microsoft und ist in weiten Teilen in C++ geschrieben. Neben C++ wird \gls{glos:actionscript} und das Adobe Flex Framework für die  Benutzeroberfläche eingesetzt. Die Architektur von \gls{Xcelsius} ist modular aufgebaut und besteht aus mehreren Teilen. Ein Überblick ist in \vref{fig:xcelsius_architektur} dargestellt.

\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=15cm]{images/Xcelsius_Architecture.jpg}
\caption{...\label{fig:xcelsius_architektur}}
\end{figure} \todo{Titel festlegen}

Das zentrale Element ist das Document. Dabei handelt es sich um ein Objektmodell, das den aktuellen Zustand des Dashboards repräsentiert. Für die Darstellung wird das Canvas verwendet, welches in \gls{glos:actionscript} geschrieben ist. Die Canvas-Komponente nutzt dabei mehrere Hilfskomponenten. Dazu gehört das ApplicationTemplate, welches das Grundgerüst von alle Dashboards darstellt und mehreren Components, die die einzelnen Elemente eines Dashboards darstellen. Dies ist auch der Ansatzpunkt für spätere Erweiterungen.

\todo{COM/OLE Erklären}
An das Document ist mittels COM/OLE Microsoft Excel angebunden. Speichern und Laden eines Dashboards übernimmt die XLF-Komponente. Diese erstellt oder lädt eine \gls{Xcelsius} File (.xlf), welches intern aus dem Document im \gls{XML}-Format und einer Excel-Datei besteht.

Für den Export des fertigen Dashboards existiert der SWF Generator. Aus dem Document und den Daten und Formeln, die in Microsoft Excel erstellt wurden, wird eine .swf Datei generiert. In dieser werden nun alle Berechnungen, die bis jetzt von Microsoft Excel übernommen wurden, von einer weiteren Hilfsklasse, der Spreadsheet Engine berechnet.\seFootcite{vgl.}{}{Xcelsius-Arch.09}

\todo{Ende einfügen!? Abschließende Worte}

\subsection{Erweiterungsmöglichkeiten}

Durch die Einstellungsmöglichkeiten der einzelnen Komponenten und die Einbindung des vollen Funktionsumfang von Microsoft Excel ist \gls{Xcelsius} von sich aus sehr flexibel. Zusätzlich dazu existiert noch ein \gls{glos:sdk} mit dem komplett eigene Komponenten erstellt werden können. Dadurch ist es möglich, \gls{Xcelsius} um nahezu beliebige Funktionen zu erweitern.

Die Erweiterungen, die mit dem \gls{glos:sdk} programmiert werden können, müssen auf dem Adobe Flex SDK 2.0.1 basieren. Die Programmiersprache ist \gls{glos:actionscript}. Es können drei verschiedene Typen von Erweiterungen mit dem \gls{glos:sdk} entwickelt werden. Dabei handelt es sich um visuelle Komponenten, die später auf dem erstellten Dashboard dargestellt werden, um Datenverbindungen, die nicht auf dem Dashboard angezeigt werden, sondern nur im Hintergrund aktiv sind und in der Regel Daten in das Excel eintragen. Die dritte Möglichkeit ist die Erweiterung der Steuerungslogik von Excel, spielt aber im Rahmen dieser Bachelorarbeit keine Rolle. \footnote{\seCite{vgl.}{S.229}{Egg.09} \seCite{und}{S.3f}{Xcelsius-SDK.08}}

\todo{Auf Connections umschreiben}
Die visuelle Komponente wiederum besteht aus zwei Teilen, die separat voneinander entwickelt werden können. Der erste Teil ist für die Darstellung der Komponente auf dem Zeichenblatt des Dashboards verantwortlich. Der zweite Teil übernimmt die Darstellung der Eigenschaften, die die Komponente bieten soll. Es ist gleichzeitig die Verbindung zwischen \gls{Xcelsius} und der entwickelten Komponente. Die Logik der Komponente kann je nach Bedarf auf beide Teile verteilt werden. Das Ergebnis der Entwicklung der beiden Teilkomponenten sind zwei .swf Dateien \todo{Checken}. Diese Dateien, in Verbindung mit Informationen zu der Komponente, wie zum Beispiel Name, Version, Typ und Entwickler werden mit dem \gls{Xcelsius} \gls{glos:sdk} zu einem \gls{Xcelsius} Plugin zusammengefügt. Dieses kann dann in \gls{Xcelsius} importiert und die Komponenten so genutzt werden.\footnote{\seCite{vgl.}{S.283f}{Egg.09} \seCite{und}{S.6}{Xcelsius-SDK.08}} Den Vorgang zeigt \vref{fig:xcelsius_plugin}.

\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=15cm]{images/Xcelsius_Plugin_Allgemein.jpg}
\caption{...\label{fig:xcelsius_plugin}}
\end{figure} \todo{Titel festlegen}

\section{Zusammenfassung}
\loreIpsum

\chapter{Spezifikation} \todo{detailreicher, in die richtung Sp der .....}
\section{Einleitung}
\loreIpsum
\section{Ausgangssituation}

In dem derzeitigen Stand des SAP LRM gibt es für die Analyse der aktuellen Liquiditätssituation einer Bank zwei Einstiegsmöglichkeiten. Es existiert die Kennzahlenanalyse und die Finanzierungsmatrix. Diese unterschieden sich in ihrer Nutzung.

Der Zweck der Kennzahlenanalyse ist die Darstellung von Kennzahlen, die nach einer festen Vorschrift berechnet werden können. Neben internen Kennzahlen, die eine Bank für sich selbst definiert hat, sind hier vor allem offizielle Kennzahlen von Bedeutung. Dazu gehören zum Beispiel im Rahmen von Basel III der \gls{glos:lcr} und der \gls{glos:nsfr}. Somit kann die Kennzahlenanalyse genutzt werden, um offizielle regulatorische Vorschriften zu überwachen. Die Darstellung der Kennzahlen ist ausschließlich in tabellarischer Form möglich. Ein Beispiel zeigt \vref{fig:lrm_istzustand_keyfigureanalysis}.

\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=15cm]{images/KeyFigureAnalysis_Example.png}
\caption{Darstellung der Kennzahlenanalyse im SAP LRM\label{fig:lrm_istzustand_keyfigureanalysis}}
\end{figure}

Neben der Kennzahlenanalyse existiert die Finanzierungsmatrix. Hier sollen nicht feste Kennzahlen dargestellt werden. Vielmehr wird  die Möglichkeit geboten, die Liquiditätssituation der Bank frei zu analysieren. Sowohl die Finanzierungsmatrix, als auch die Kennzahlenanalyse, nutzen für die Berechnung der Werte die Berechnungskomponente. Bei der Finanzierungsmatrix hat der Nutzer die Möglichkeit, die Selektionskriterien in Form der nötigen Parameter für den Aufruf der Berechnungskomponente zur Laufzeit festlegen. Die Darstellung ist hier auf ein Liniendiagramm festgelegt. \vref{fig:lrm_istzustand_fundingmatrix} zeigt die Finanzierungsmatrix.

\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=15cm]{images/Funding_Matrix_Example.png}
\caption{Darstellung der Finanzierungsmatrix im SAP LRM\label{fig:lrm_istzustand_fundingmatrix}}
\end{figure}

Allgemein ist festzustellen, dass in der aktuellen Version keine Möglichkeit besteht, die Ergebnisse der Berechnungen in irgendeiner Form in anderen Auswertungen, zum Beispiel Auswertungen, die die gesamte Situation der Bank beschrieben, einzubinden. Des Weiteren besteht bei der Darstellung der Ergebnisse keine Formatierungsmöglichkeit. Somit sind zum Beispiel Farbe, Form und Größe des Diagramms fest vorgegeben und nicht durch den Nutzer änderbar.

\section{Zielsetzung}
\label{sec:zielsetzung}

Im Rahmen dieser Bachelorarbeit sollen einige Limitierungen, die in der aktuellen Version des SAP LRM vorhanden sind, aufgehoben werden. Hier ist vor allem die Bereitstellung von weiteren Alternativen zu nennen. Neben der Sicht auf die Liquiditätssituation der Bank durch die beiden Einstiegspunkte Kennzahlenanalyse und der Finanzierungsmatrix im SAP LRM soll diese Auswertung mit Hilfe von weiteren Anwendungen durchgeführt werden können.

Durch die Anbindung von weiteren Anwendungen bietet sich die Möglichkeit, die  Liquiditätssteuerung in die Gesamtsteuerung der Bank einzubinden. Ein Ziel ist es, in einen Bericht, der Daten zu der allgemeinen Situation der Bank anzeigt, auch Informationen über das Liquiditätsrisikomanagement aufzunehmen. Dadurch kann die Situation der Bank gesamtheitlich erfasst werden und Entscheidungen unter der Berücksichtigung von weiteren Informationen getroffen werden.

Simultan dazu können durch eine Anbindung des SAP LRM an weitere Anwendungen die jeweiligen Vorteile der angebundenen Anwendung ausgenutzt werden. Hier ist zum Beispiel die Flexibilität in der Darstellung der Daten zu nennen. Wenn die Anwendung weitere grafische Visualisierungsmöglichkeiten bietet, können diese auf die Daten des SAP LRM angewendet werde.

Insgesamt soll die Anbindung des SAP LRM mit möglichst wenig erforderlichen Einstellungen konfigurierbar sein. Gleichzeitig ist es erstrebenswert, dass das Konzept der Anbindung und die Implementierung, die im Rahmen der Bachelorarbeit entwickelt wird, in der grundsätzlichen Idee und Architektur auch auf weitere Anwendungen übertragen werden kann.

\section{Anforderungen}
\label{sec:anforderungen}
Für die Erweiterung werden im Rahmen der Spezifikation einige Anforderungen definiert. Die Anforderungen werden zunächst in funktionale und nicht-funktionale Anforderungen unterteilt. 

Bei den funktionalen Anforderungen existieren die zwei Folgenden Hauptanforderungen:

\begin{seToplist}{ XXXXX }

\item[\anfl{kpi}] \textbf{Einbindung von Kennzahlen} \newline
Die Erweiterung soll es ermöglichen, dass Kennzahlen, die im SAP LRM  mit Hilfe der Berechnungskomponente ermittelt werden und im Bereich der Kennzahlenanalyse zur Verfügung stehen, in weitere Anwendungen integriert werden und dort weiterverarbeitet werden können.

\item[\anfl{fundingMatrix}] \textbf{Freie Analyse der Liquiditätssituation} \newline
Mit der Erweiterung soll die Einbindung der Ergebnisse von beliebigen Liquiditätsgruppen ermöglicht werden. Die Liquiditätsgruppen sollen in Anlehnung an die Finanzierungsmatrix im SAP LRM eingestellt werden und auf der Berechnungskomponente basieren. Neben den erforderlichen Parametern, wie zum Beispiel dem genutzte Laufzeitband und der Zielwährung sollen weitere Einschränkungsmöglichkeiten geboten werden, welche die Berechnungskomponente unterstützt.

\end{seToplist}

Durch die Umsetzung dieser beiden  Anforderungen können die Ziele, die im \vref{sec:zielsetzung} festgelegt sind, erreicht werden. Dadurch bieten sich für den Nutzer bei der Auswertung und Analyse der Liquiditätssituation einer Bank zusätzliche Möglichkeiten.

Neben den funktionalen Anforderungen wurden auch nicht-funktionale Anforderungen identifiziert. Diese sollen im Folgenden näher erläutert werden:

\begin{seToplist}{ XXXXX }

\item[\anfl{uebertragbarkeit}] \textbf{Übertragbarkeit} \newline
Im Rahmen der Bachelorarbeit wird exemplarisch die Anbindung einer weiteren Anwendung zur Auswertung an das SAP LRM implementiert werden. Das Konzept der Umsetzung soll dennoch auf weitere Anwendungen übertragen werden können.

\item[\anfl{korrektheit}] \textbf{Korrektheit der Ergebnisse} \newline
Die Daten, die mit Hilfe der Erweiterung in zusätzlichen Anwendungen verfügbar gemacht werden, müssen mit den Ergebnissen des SAP LRM übereinstimmen. Nur wenn das sichergestellt ist, kann die Erweiterung sinnvoll genutzt werden.

\item[\anfl{erweiterbarkeit}] \textbf{Erweiterbarkeit} \newline
Das SAP LRM befindet sich aktuell noch in einer ersten Version in Entwicklung. Weitere Versionen sind schon jetzt in Planung. Zusätzliche Funktionen und Möglichkeiten, die in einer Weiterentwicklungen des SAP LRM eingeführt werden, sollen mit möglichst geringem Aufwand auch auf die Erweiterung übertragen werden können.

\item[\anfl{wartbarkeit}] \textbf{Wartbarkeit} \newline
Um die Folgekosten der Erweiterung, zum Beispiel im Hinblick auf die Beseitigung von Fehlern, möglichst gering zu halten, soll eine gute Wartbarkeit von Anfang an bei der Entwicklung beachtet werden.

\item[\anfl{sicherheit}] \textbf{Sicherheitsanforderungen} \newline
Die Erweiterungen wird Zugang zu den Daten des SAP LRM bieten. Es handelt sich dabei um vertrauliche Daten, die  Zugangsbeschränkungen unterliegen. Es muss sichergestellt sein, dass die Zugangsbeschränkungen eingehalten werden und Daten nicht von unberechtigten Personen ausgelesen werden können.

\item[\anfl{leistung}] \textbf{Leistung} \newline
Ein wichtiges Unterscheidungsmerkmal des SAP LRM durch die Nutzung von \gls{HANA} ist die schnelle Analyse von Daten. Die Erweiterung soll die Geschwindigkeitsvorteile von \gls{HANA} auch in anderen Anwendungen verfügbar machen.

\end{seToplist}

Die Reihenfolge der Anforderungen spiegelt gleichzeitig auch die Priorität der Umsetzung wieder. Die wichtigsten Anforderungen sind \anfRef{anf:uebertragbarkeit}{} und \anfRef{anf:korrektheit}{}. \anfRef{anf:leistung}{} steht bei der Entwicklung nicht im Mittelpunkt.

\section{Anwendungsfälle}
Zum besseren Verständnis des Ziels der Erweiterung werden die Hauptanwendungsfälle im Folgenden näher beschrieben. Der Anwendungsfall 1\usecaseRef{useCase:1} konkretisiert die \anfRef{anf:kpi}{} und behandelt die Einsicht in wichtige Liquiditätskennzahlen einer Bank.

\useCase{1: Liquiditätskennzahl einsehen}{ \label{useCase:1}

\useCaseEntry{Ziel}{Liquiditätskennzahl der Bank einsehen}
\useCaseEntry{Vorbedingung}{Die Liquiditätskennzahl ist im SAP LRM angelegt und verfügbar}
\useCaseEntry{Nachbedingung: Erfolg}{Die Liquiditätskennzahl kann eingesehen werden}
\useCaseEntry{Nachbedingung: Fehlschlag}{Anzeige einer Fehlermeldung}
\useCaseEntry{Akteure}{Controller, Manager}
\useCaseEntry{Auslösendes Ereignis}{Der Wert der Liquiditätskennzahl soll überprüft werden}

\textbf{Beschreibung}
\begin{seToplist}{ x 1 x }
\vspace*{-4mm}
\useCaseItem{1}{Die einzusehende Liquiditätskennzahl wird ausgewählt}
\useCaseItem{2}{Die Daten werden aus dem SAP LRM ermittelt}
\useCaseItem{3}{Die Daten werden der Anwendung zur Verfügung gestellt}
\end{seToplist}

}

Der Anwendungsfall 2\usecaseRef{useCase:2} bezieht sich auf die \anfRef{anf:fundingMatrix}{}. Hierbei geht es um die freie Analyse der Liquiditätssituation einer Bank.

\useCase{2: Liquiditätssituation analysieren}{ \label{useCase:2}

\useCaseEntry{Ziel}{Liquiditätssituation der Bank analysieren}
\useCaseEntry{Vorbedingung}{Erforderliche Zahlungsströme, Liquiditätsszenarien, Liquiditätsgruppen und Laufzeitbänder sind im SAP LRM angelegt und verfügbar}
\useCaseEntry{Nachbedingung: Erfolg}{Die Liquiditätssituation kann eingesehen werden}
\useCaseEntry{Nachbedingung: Fehlschlag}{Anzeige einer Fehlermeldung}
\useCaseEntry{Akteure}{Controller, Manager}
\useCaseEntry{Auslösendes Ereignis}{Es besteht Unklarheit über die Liquiditätssituation der Bank}

\textbf{Beschreibung}
\begin{seToplist}{ x 1 x }
\vspace*{-4mm}
\useCaseItem{1}{Der zu analysierende Zeitraum wird mit dem Laufzeitband festgelegt}
\useCaseItem{2}{Die Zielwährung der Analyse wird festgelegt}
\useCaseItem{3}{Das Liquiditätsszenario wird festgelegt}
\useCaseItem{4}{Die zu analysierenden Liquiditätsgruppen werden festgelegt}
\useCaseItem{5}{Die Daten werden aus dem SAP LRM ermittelt}
\useCaseItem{6}{Die Daten werden der Anwendung zur Verfügung gestellt}
\end{seToplist}

\textbf{Erweiterungen}
\begin{seToplist}{ x 1 x }
\vspace*{-4mm}
\useCaseItem{4a}{Weitere Selektionsmerkmale, zum Beispiel nach Produkttyp oder Organisationseinheit werden festgelegt}
\useCaseItem{6a}{Die Daten werden in der Anwendung weiterverarbeitet}
\useCaseItem{6b}{Die Daten werden in der Anwendung visualisiert}
\end{seToplist}

}

\section{Zusammenfassung}
\loreIpsum
\chapter{Umsetzungsmöglichkeiten}
\section{Einleitung}
\loreIpsum
\section{Rahmenbedingungen}
Bis zu diesem Zeitpunkt ist die Arbeit, mit Ausnahme der Vorstellung von \gls{Xcelsius} in \vref{sec:xcelsius}, allgemein gehalten. Die Spezifikation beschreibt ein allgemeines Konzept für die Einbindung von Daten des SAP LRM zur weiteren Analyse. Für das weitere Vorgehen soll das Konzept an dem konkreten Beispiel von \gls{Xcelsius} umgesetzt werden. Der folgende Teil behandelt demnach die konkrete Anbindung von \gls{Xcelsius} an das SAP LRM. Gleichzeitig soll aber bei der Analyse und dem Entwurf die \anfRef{anf:uebertragbarkeit}{an die Übertragbarkeit } wenn möglich weiterhin beachtet werden.

\section{BusinessObjects Universum}
Eine Möglichkeit, externe Daten in \gls{Xcelsius} zu integrieren, stellt BusinessObjects Universum dar. Dabei handelt es sich um eine Zwischenschicht, die zwischen dem Bereitsteller der Daten und dem Konsumenten geschaltet wird. Ein Universum ist dabei eine semantische Ebene, die es ermöglicht Daten zu konsumieren, ohne die technischen Aspekte der Datenbank kennen zu müssen.\seFootcite{vgl.}{S.48f}{Universe.06}

\todo{Inline-Erklärung zu Sternschema und normalisierter Form schreiben}
Es können Daten aus relationalen \gls{DBMS}, die zum Beispiel in normalisierter Form vorliegen, und aus Data-Warehouse-Systeme, die Daten zum Beispiel im Sternschema ablegen, konsumiert werden. Das Universum abstrahiert diese Daten auf Objekte, die dem Nutzer bereitgestellt werden.\seFootcite{vgl.}{S.49}{Universe.06} Dies zeigt \vref{fig:universe_abstraktion}.

\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=15cm]{images/universe_ueberblick.jpg}
\caption{...\label{fig:universe_abstraktion}}
\end{figure} \todo{Titel festlegen}

Die Einbindung von Universen wird in \gls{Xcelsius} standardmäßig unterstützt. Es könnte somit im SAP LRM eine oder mehrere Datenbanktabellen erstellt werden, die mit den Ergebnissen der Berechnungskomponente gefüllt werden. Für diese Datenbanktabellen wird ein Universum erstellt, welches dann schließlich an \gls{Xcelsius} angebunden wird. Ein Überblick ist in \vref{fig:umsetzung_universe} dargestellt.

\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=15cm]{images/umsetzung_universe.jpg}
\caption{Umsetzungsmöglichkeit der Erweiterung mittels BusinessObjects Universum \label{fig:umsetzung_universe}}
\end{figure}

Da ein Universum allerdings nur lesenden Zugriff auf die Daten bietet, stellt sich die Frage, wie eventuelle Selektionsparameter von \gls{Xcelsius} an die Berechnugnskomponente übergeben werden können. Zusätzlich muss die Berechnung durch die Berechnungskomponente manuell angestoßen werden, um die Tabelle mit den aktuellen Daten zu füllen. Eine automatische, periodische Berechnung, zum Beispiel durch einen eingeplanten Hintergrundprozess, würde stets veraltete Daten liefern.

Schließlich sind Universen nur für die Verwendung mit BusinessObjects Anwendungen ausgelegt. Das Kriterium der Übertragbarkeit in \anfRef{anf:uebertragbarkeit}{} kann somit nicht garantiert werden.

\section{Webservice}
Eine weitere Möglichkeit stellen Webservices dar. Für die Umsetzung muss im SAP LRM der Webservice implementiert werden. In \gls{Xcelsius} wird dieser Webservice aufgerufen und somit über den Webservice Daten konsumiert. Ein Überblick stellt \vref{fig:umsetzung_webservice} dar, welche im Folgenden näher erläutert wird.

\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=15cm]{images/umsetzung_webservice.jpg}
\caption{Umsetzungsmöglichkeit der Erweiterung mittels Webservices \label{fig:umsetzung_webservice}}
\end{figure}

Dadurch, dass der Aufruf direkt im SAP LRM entgegen genommen wird und nicht indirekt, zum Beispiel über ein Universum erfolgt, können eventuelle Selektionsparameter dynamisch übergeben werden. Auch das Problem mit veralteten Daten besteht nicht, da die Berechnung bei jedem Aufruf nach Bedarf durchgeführt werden kann.

Werden für die Umsetzung der Webservices offene Standards wie zum Beispiel \gls{HTTP} für die Übertragung oder die \gls{XML} als Beschreibungssprache eingesetzt, können die Webservices auch von anderen Anwendungen verwendet werden. Dies ist für das Kriterium der Übertragbarkeit in \anfRef{anf:uebertragbarkeit}{} wichtig.

Außerdem kommt hinzu, dass bei dieser Umsetzungsmöglichkeit eine gute Modularisierung und Wiederverwendbarkeit erreicht werden kann. Die benötigte Funktionalität kann auf mehrere kleine Webservices aufgeteilt werden. Es entstehen voneinander unabhängige Teile, die leichter gewartet und unabhängig voneinander verwendet werden können. In \gls{Xcelsius} müssen diese Teile dann orchestriert werden.

\todo{Framework erklären?! -> wenn gute erklärung gefunden wird}
Teile des SAP LRM wurden mit Hilfe eines Frameworks umgesetzt. Dieses bietet die Möglichkeit, bestimmte Klassen ohne zusätzlichen Programmieraufwand automatisch über einen Webservice bereitzustellen. Dazu zählen unter anderem die Liquiditätsszenarien und die Laufzeitbänder. Somit könnten Teile der Webservices ohne großen Aufwand umgesetzt werden.

Ein mögliches Risiko dieser Umsetzungsmöglichkeit stellt die \anfRef{anf:leistung}{an die Performance } dar. Der zusätzliche Aufwand für das Aufrufen von mehreren Webservices, in festgelegten Reihenfolgen und Abhängigkeiten, kann zu einer längeren Gesamtlaufzeit führen. Zusätzlich führt der Ausfall eines Teil-Webservice zur Funktionsunfähigkeit der gesamten Erweiterung.

\gls{Xcelsius} bietet zwar eine Möglichkeit zur Einbindung von einzelnen Webservices, allerdings besteht standardmäßig keine Möglichkeit, mehrere Webservices zusammenzusetzen und zu orchestrieren. Dafür müsste eine eigene Erweiterung auf Basis des \gls{Xcelsius} \gls{glos:sdk} entwickelt werden.

\section{Gegenüberstellung und Auswahl der Umsetzungsmöglichkeiten}

\todo{Text schreiben !=}
Für die Auswahl der im Rahmen der Bachelorarbeit angewendeten Umsetzungsmöglichkeit wurden die Vor- und Nachteile der Alternativen ermittelt und in \vref{table:vergleich_umsetzung} gegenübergestellt.

{
\setlength{\extrarowheight}{2pt}
\begin{table}[htbp]
\centering
\begin{tabular}{| l | >{\centering\arraybackslash} m{5cm} | >{\centering\arraybackslash} m{5cm} |}
\cline{2-3}
\multicolumn{1}{l|}{}	& Vorteile & Nachteile \\	\hline
BO Universe 				&

%- Vorteile BOUniverse

\begin{seList}
\item Standardmäßige Anbindung von Universen
\end{seList}

&
%- Nachteile BOUniverse


\begin{seList}
\item zusätzliche Infrastruktur notwendig
\item Übertragbarkeit auf andere Anwendungen
\item Problem der dynamischen Übergabe von Parametern
\item Problem der Aktualisierung der berechneten Daten
\end{seList}


\\	\hline
Webservices 			& 
%- Vorteile Webservices

\begin{seList}
\item Übergabe von Selektionsparametern einfach möglich
\item keine zusätzliche Infrastruktur erforderlich
\item gute Modularisierung und Übertragbarkeit
\item teilweise Bereitstellung von Webservices durch Framework
\end{seList}

& 

%- Nachteile Webservices

\begin{seList}
\item Komplexe Orchestrierung erforderlich
\item Performanceprobleme bei Webservice-Aufrufen
\item Ausfall eines Teil-Webservice führt zum Ausfall des Gesamtsystems
\end{seList}

\\	\hline
\end{tabular} 
\caption{Gegenüberstellung der Vor- und Nachteile der Umsetzungsmöglichkeiten für die Erweiterung \label{table:vergleich_umsetzung}}
\end{table}
}

Bei der Gegenüberstellung fällt auf, dass die Umsetzung mit Hilfe von BusinessObjects Universe im Vergleich zu der Umsetzung über Webservices deutlich weniger Vorteile bietet. Gleichzeitig bieten die Möglichkeit mit BusinessObjects Universe zusätzlich noch mehr Nachteile. Unter diesen Nachteilen findet sich auch die ungelöste Frage der Parameterübergabe und die fehlende Übertragbarkeit auf andere Anwendungen, welche als wichtige Anforderung definiert ist.

Aus diesen Gründen wurde sich für die weitere Vorgehensweise für die Umsetzung mit Hilfe von Webservices entschieden.



\section{Zusammenfassung}
\loreIpsum
\chapter{Umsetzung}
\section{Einleitung}
\loreIpsum
\section{Analyse}

\subsection{Überblick}
In diesem Abschnitt wird der Analyseprozess der Entwicklung näher betrachtet. Die Ermittlung der Anforderungen an die Anwendung, welches ein Teil der Analysephase ist, wurde in diesem Fall schon in dem allgemeinen Teil der Bachelorarbeit in \vref{sec:anforderungen} durchgeführt. Die dort ermittelten Anforderungen werden ohne Änderungen übernommen und in dem Folgenden nicht noch einmal näher erläutert.

Die Entwicklung der Erweiterung für \gls{Xcelsius} kann in fünf Teilbereiche unterteilt werden. Sie werden für die Strukturierung der Analyse genutzt. Bei den Bereichen handelt es sich um folgende Teile:


\begin{seToplist} { XX }
\item[1] Bereitstellung der Webservice im SAP LRM \newline
Das SAP LRM System stellt über Webservices alle benötigten Daten bereit.

\item[2] Konsumierung der Webservice in \gls{Xcelsius} \newline
Die Webservices werden konsumiert und zunächst in ein internes Objektformat umgewandelt.

\item[3] Orchestrierung der Webservice in \gls{Xcelsius} \newline
Die Ergebnisse der Konsumierung der Webservices werden miteinander verbunden und in eine interne Zielobjektstruktur umgewandelt.

\item[4] Dateiaustausch zwischen der Erweiterung und \gls{Xcelsius} \newline
Die Ergebnisse der Orchestrierung müssen in das Tabellenblatt von \gls{Xcelsius} geschrieben und Selektionsparameter aus dem Tabellenblatt gelesen werden.

\end{seToplist}

\subsection{Grundlegende Architektur und Funktionsweise}
In diesem Abschnitt wird ein Überblick (siehe dazu \vref{fig:ueberblick-architektur}) über die grundlegende Architektur der Lösung gegeben. Dabei werden Erweiterungen in zwei Systemen, dem SAP LRM und \gls{Xcelsius}, umgesetzt. Gleichzeitig wird die grundlegende Funktionsweise, gerade im Hinblick auf die Interaktion mit dem Nutzer, näher gebracht.

\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=15cm]{images/Ueberblick-Architektur.jpg}
\caption{Überblick der grundlegenden Architektur der Erweiterung\label{fig:ueberblick-architektur}}
\end{figure}

Im SAP LRM System muss für jeden Webservice ein Webservice-Provider bereitgestellt werden. Der Webservice-Provider kann über einfache Funktionsaufrufe entweder Berechnungen über die Berechnungskomponente durchführen lassen, oder auf Objekte des SAP LRM, wie zum Beispiel einem Laufzeitband oder eine Liquiditätsgruppe zugreifen. Das Ergebnis liefert er über \gls{HTTP} im \gls{XML}-Format.

Die drei restlichen Teile, die im Überblick eingeführt wurden, werden in einem Plugin für \gls{Xcelsius} implementiert. Dazu zählt die Konsumierung der bereitgestellten Services und anschließend die Orchestrierung.

Der \gls{Xcelsius}-Adapter ist über ein Tabellenblatt die Schnittstelle für den Nutzer. Das Tabellenblatt wird dabei in zwei Bereiche unterteilt. Dies sind ein Daten- und ein Einstellungs-Teil. Die Ergebnisse der Erweiterung werden von dem Adapter in den Daten-Teil geschrieben. Damit endet die Zuständigkeit der Erweiterung. Der Nutzer kann die Daten beliebig weiterverarbeiten, in der Regel wird er sie mit Diagrammen visualisieren.

Die Selektionsparameter, die zum Beispiel für die Berechnungskomponente im SAP LRM gebraucht werden (siehe dazu \vref{sec:berechnungskomponente:parameter}), werden aus dem Einstellungs-Teil des Tabellenblatts ausgelesen. Wie die Daten von dem Nutzen in den Bereich geschrieben werden, ist wiederum komplett dem Nutzer überlassen. Eine Möglichkeit sind Kombinationsfelder, die \gls{Xcelsius} standardmäßig bereitstellt.

Die Erweiterung stellt nur die Möglichkeit zur Verwendung von Daten aus dem SAP LRM in \gls{Xcelsius} bereit. In welcher Form die Daten weiter verarbeitet werden, wird bewusst komplett offengelassen.

\subsection{Statisches Modell}
Für diese Bereiche wurde in einem ersten Schritt die grundlegenden Klassen und ihre Assoziationen zueinander identifiziert. Das entsprechende Klassendiagramm der Analysephase ist in \vref{fig:klassendiagramm_analyse} dargestellt.

\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=15cm]{Visio/Analyse.pdf}
\caption{Klassendiagramm der Analysephase \label{fig:klassendiagramm_analyse}}
\end{figure}

Das Kernstück der Erweiterung ist die Klasse \class{Orchestrator}. Hier ist die komplette Logik der Orchestrierung für die Kennzahlenanalyse und die Finanzierungsmatrix hinterlegt, das heißt die Ergebnisse der einzelnen Webservices werden kombiniert. Dazu existieren die entsprechenden Methoden \method{updateKPI()} und \method{updateFundingMatrix()}. Für den Datenaustausch mit dem Tabellenblatt von \gls{Xcelsius} existiert zwischen der Klasse \class{Orchestrator} und der Klasse \class{XcelsiusAdapter} eine 1:1 Assoziation.

Die Klasse \class{XcelsiusAdapter} stellt die Verbindung zwischen der Erweiterung und dem Tabellenblatt von \gls{Xcelsius} dar. Mit der Methode \method{writeToXcelsius()} können Daten in das Tabellenblatt geschrieben werden. Zum Lesen von Daten existiert die Methode \method{readFromXcelsius()}.

Eine weitere wichtige Klasse stellt der \class{ObjectProvider} dar. Ein \class{ObjectProvider} ist eine abstrahierte Schicht über einem Webservice. Die Aufgabe eines \class{ObjectProvider} ist der einfache Zugriff auf Objekte, die über einen Webservice bezogen werden. Dieser Zugriff findet über die Methode \method{getObject()} statt. Mehrere \class{ObjectProvider} sind Teil der Klasse \class{Orchestrator}, zwischen diesen beiden Klassen existiert eine Komposition.

Um die Webservices abstrahiert darstellen zu können, nutzt ein \class{ObjectProvider} zwei weiteren Klassen, den \class{WebServiceConnector} und den \class{Deserializer}. Hier besteht jeweils eine 1:1 Assoziation. Der \class{WebServiceConnector} übernimmt die Kommunikation zwischen der Erweiterung und dem SAP LRM System über \gls{HTTP}. Der \class{Deserializer} wandelt das Resultat der Kommunikation über den Webservice in ein internes Objektformat um.

Die Klasse \class{WebServiceProvider} muss im SAP LRM implementiert werden. Sie nimmt die Anfragen der Erweiterung über \gls{HTTP} entgegen, liest die entsprechenden Objekte aus der Datenbank und serialisiert sie im \gls{XML}-Format.

\subsection{Dynamisches Modell}
Um eine bessere Vorstellung von den Vorgängen zu erlangen, wird in dem Folgenden exemplarisch der Ablauf einer Anfrage durch einen Nutzer erläutert. Das entsprechende Sequenzdiagramm ist in \vref{fig:sequenz_analyse} dargestellt.

\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=15cm]{Visio/Analyse-Sequenz.pdf}
\caption{Sequenzdiagramm der Analysephase \label{fig:sequenz_analyse}}
\end{figure}


In dem Beispiel möchte der Nutzer den Wert einer Kennzahl abfragen. Dazu ruft er in der \instance{Orchestrator}-Instanz die Methode \method{updateKPI()} auf.

Daraufhin werden drei Schritte durchlaufen, die in dem Diagramm auf der linken Seite markiert sind. Zunächst wird über den \instance{XcelsiusAdapter} die aktuellen Selektionseinstellungen des Nutzers ermittelt. Dazu gehört die Kennzahl, die abgerufen werden soll und eventuell weitere Einstellungen.

Anschließend wird in einem zweiten Schritt ein oder mehrere Webservices über die entsprechenden \instance{WebServiceProvider} konsumiert. Die Objekte, die die \instance{WebServiceProvider} zurückliefern werden durch den \instance{Orchestrator} verbunden.

Die \instance{WebServiceProvider} rufen über einen \instance{WebServiceConnector} den \gls{XML}-Inhalt ab. Anschließend wird das Ergebnis an den entsprechenden \instance{Deserializer} weitergegeben. Dieser wandelt es in eine interne Objektstruktur um und gibt die Instanz an den \instance{ObjectProvider} zurück. Dieser leitet es an den \instance{Orchestrator} weiter.

Der Aufruf der \instance{WebServiceProvider} durch den \instance{Orchestrator} kann asynchron erfolgen. Hat der \instance{Orchestrator} alle Ergebnisse der \instance{ObjectProvider} erhalten, erfolgt die Umwandlung in das Zielobjektformat und schließlich in dem dritten Schritt das Übergeben des Ergebnis an den \instance{XcelsiusAdapter}. Dieser schreibt die Daten in das Tabellenblatt von \gls{Xcelsius}.

Dadurch stehen die Daten dem Nutzer in \gls{Xcelsius} zur Verfügung. Der Aufruf von \method{updateKPI()} ist fertig.

\section{Entwurf}

\subsection{Orchestrierung der Webservices}
Durch die Verwendung eines \gls{glo:abap}-Frameworks zur Implementierung von wichtigen Klassen im SAP LRM, existieren schon Webservices, die für die Erweiterungen genutzt werden können. Bei den Klassen handelt es sich um:

\begin{seList}
\item Laufzeitband
\item Liquiditätsszenario
\item Liquiditätsgruppe
\end{seList}

Hierfür bietet das Framework eine Schnittstelle, mit der auf die Objekte über das \gls{glos:atom} zugegriffen werden kann. Diese Webservices können in der Erweiterung genutzt werden. Zusätzlich befindet sich eine iPad-App für das SAP LRM in Entwicklung. Für diese wurden zwei weitere Webservices entwickelt, die dem Zugriff auf Kennzahlen und die Finanzierungsmatrix bieten.

Es ergeben sich fünf nutzbare Webservices, die orchestriert werden müssen. Das Ziel ist immer der Zugriff auf den Webservice der Finanzierungsmatrix oder den Webservice für die Kennzahlen. Die Abhängigkeiten der jeweiligen Webservices sind in \vref{fig:webservice_abhaengigkeiten} dargestellt und sollen im Folgenden erläutert werden:

\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=15cm]{images/WebService-Abhaengigkeiten.jpg}
\caption{Abhängigkeiten der Webservices\label{fig:webservice_abhaengigkeiten}}
\end{figure}


Der Webservice der Finanzierungsmatrix ruft bei einem Aufruf die Berechnungskomponente des SAP LRM auf und muss demnach mit den vier erforderlichen Parametern versorgt werden (siehe dazu \vref{sec:berechnungskomponente:parameter}). Es besteht eine Abhängigkeit zu den drei Webservices, die automatisch durch das Framework  bereit stehen. Der Webservice der Liquiditätsgruppen ist so umgesetzt, dass er ein Liquiditässzenario als Parameter erwartet und darauf alle möglichen Liquiditätsgruppen zurückliefert -- auch hier besteht eine Abhängigkeit.

Der Webservice der Kennzahlen erfordert keine Parameter und kann eigenständig aufgerufen werden. Er liefert alle Kennzahlen, die im SAP LRM angelegt und verfügbar sind. Das Resultat beinhaltet allerdings nicht alle Informationen, zum Beispiel zu dem verwendeten Liquiditätsszenario für die Berechnung oder der hinter liegenden Liquiditätsgruppe. Das Ergebnis kann also durch weitere Aufrufe von Webservices angereichert werden.

\subsection{Statisches Modell}
Im Gegensatz zu der Analyse wird der Entwurf auf einer höheren Detailstufe durchgeführt und das Resultat der Analyse auch im Hinblick auf die Performance untersucht und optimiert. Das sich daraus ergebene Klassendiagramm ist in \vref{fig:klassendiagramm_entwurf} zu sehen.


\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=15cm]{Visio/Entwurf.pdf}
\caption{Klassendiagramm der Entwurfsphase\label{fig:klassendiagramm_entwurf}}
\end{figure}

Objekte, wie zum Beispiel ein Liquiditätsszenario oder ein Laufzeitband, werden nur einmal angelegt und danach in der Regel nicht mehr geändert. Bei der Orchestrierung der Webservices müsste allerdings nach dem Ergebnis der Analyse jedes Mal eine neue Abfrage gestartet werden. Um das zu verhindern wird die Klasse \class{ObjectProvider} durch die neu hinzugefügte Klasse \class{CachedObjectProvider} erweitert. Ein \class{CachedObjectProvider} hält alle Objekte, die schon einmal angefragt wurden, in einem internen Cache und liefert bei einer erneuten Nachfrage das Objekt aus dem Cache zurück, ohne einen neuen Webservice aufrufen zu müssen.

Für das Ermitteln der aktuellen Einstellungen, die der Nutzer in dem Tabellenblatt von \gls{Xcelsius} hinterlegt hat, wurde die Klasse \class{SettingProvider} hinzugefügt. Der \class{SettingProvider} nutzt den \class{XcelsiusAdapter} zum Auslesen des Tabellenblattes und liefert über die Methode \method{getSetting()} alle erforderlichen Einstellungen für die Abfragen der Webservices zurück. Dadurch kann der \class{XcelsiusAdapter} sich rein auf das funktionale Lesen und Schreiben des Tabellenblattes beschränken und von der Logik, welche Zelle wie ausgelesen werden muss, befreit werden.

Für den einfachen Zugriff auf die einzelnen \class{ObjectProvider} wurde der Klasse \class{Orchestrator} die Hilfsmethode \method{getProviderForType()} hinzugefügt. Die später von dem Nutzer aufgerufenen Methoden \method{updateKPI()} und \method{updateFundingMatrix()} nutzen die neuen Hilfsmethoden \method{getKIP()} und \method{getFundingMatrix()}. Durch die neue Signatur kann der \class{XcelsiusAdapter} und der \class{SettingProvider} einfacher angebunden werden.


\label{sec:entwurf:statisch:orchestratorresult}
Zudem legt mit der Klasse \class{OrchestratorResult} die Zielobjektstruktur der Orchestrierung fest. Eine Instanz der Klasse \class{OrchestratorResult} besteht dabei aus beliebig vielen \class{Result}-Instanzen. Genauer gesagt wird für jede abgefragte Liquiditätsgruppe eine \class{Result}-Instanz erzeugt.

Eine \class{Result}-Instanz hat zum einen mehrere Parameter. Diese sind, um eine gute Erweiterbarkeit zu erreichen, in einfachen Key-Value Paaren verwaltet. Beispiele für Parameter können die Liquiditätsgruppe und das genutzte Liquiditätsszenario sein. Zum anderen werden in dem Attribut \class{values} die einzelnen Werte gespeichert.

Die Werte beziehen sich in ihrer Reihenfolge auf das zugrundeliegende Laufzeitband. Dieses ist für alle \class{Result}-Instanzen das gleiche und ist deshalb nur einmal als Attribut des \class{OrchestratorResult} vorhanden. Die einzelnen Abschnitte des Laufzeitbandes sind in dem Attribut \class{parts} abgelegt. Ein Laufzeitbandabschnitt hat eine Beschreibung, ein Start und ein End-Datum.

Generell wurden alle Klassen um typisierte Attribute erweitert. Den Methoden wurde die Signatur hinzugefügt.

\subsection{Dynamisches Modell}

An dem Dynamischen Modell müssen in der Entwurfsphase nur kleinere Änderungen durch die neu hinzugekommenen Klassen durchgeführt werden. Das angepasste Sequenzdiagramm ist in \vref{fig:sequenz_entwurf} dargestellt.

\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=15cm]{Visio/Entwurf-Sequenz.pdf}
\caption{Sequemzdiagramm der Entwurfsphase\label{fig:sequenz_entwurf}}
\end{figure}

In Abschnitt (1) ist die Einbindung des \class{SettingProvider} zu sehen. Außerdem lässt sich das Zusammenspiel zwischen der öffentlichen, parameterfreien Methode \method{updateKPI()} und der privaten Methode \method{getKPI()} sehen. In der Orchestrierung wird nun auch ein \class{CachedObjectProvider} verwendet. Dieser hatte das angeforderte Objekt schon einmal über seinen Webservice abgefragt und in seinem Cache zwischengespeichert. Dieser Vorgang ist in dem Sequenzdiagramm aus Platzgründen nicht abgebildet. Die erneute Anfrage kann er ohne einen weiteren Aufruf eines Webservice direkt beantworten.

\subsection{Zielstruktur in \gls{Xcelsius}}
Eine zentrale Rolle in der Erweiterung spielt die Übergabe der Ergebnisse der Orchestrierung an das Tabellenblatt von \gls{Xcelsius}. Dies muss in einer Art und Weise geschehen, sodass der Nutzer die Daten später einfach weiterverarbeiten oder visualisieren kann.

Diese Aufgabe wird von dem \class{XcelsiusAdapter} übernommen. Ausgangspunkt ist immer eine \class{OrchestratorResult}-Instanz, welche das Ergebnis der Orchestrierung darstellt. Den Aufbau der Instanz ist in \vref{sec:entwurf:statisch:orchestratorresult} dargestellt. Diese Objektstruktur muss in eine Tabellenstruktur in \gls{Xcelsius} umgewandelt werden. Ein konkretes Beispiel für die Objektstruktur zeigt \vref{fig:objektstruktur}, welches in \vref{tab:zielstruktur} entsprechend umgesetzt ist.

\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=15cm]{Visio/Entwurf-Objektstruktur.pdf}
\caption{Interne Objektstruktur vor der Umwandlung durch den XcelsiusAdapter \label{fig:objektstruktur}}
\end{figure}


% Table generated by Excel2LaTeX from sheet 'Sheet1'
\begin{table}[htbp]
  \centering
  \caption{Ergebnis der Umwandlung durch den XcelsiusAdapter}
    \begin{tabular}{l|r|r}
    \toprule
    \textbf{Liquiditätsgruppe:} & \textbf{FLE} & \textbf{FLE} \\
    \textbf{Liquiditätszenario:} & \textbf{Krise} & \textbf{Baseline} \\
    \midrule
    1 Tag & 1,05  & 1,05 \\
    1 Monat & 0,95  & 1,06 \\
    1 Jahr & 0,70  & 1,10 \\
    \bottomrule
    \end{tabular}%
  \label{tab:zielstruktur}%
\end{table}%

Die Tabellenstruktur soll folgendermaßen aufgebaut werden: Eine Ergebnissreihe wird immer in einer Spalte dargestellt. Dabei handelt es sich um alle Ergebniswerte, die für eine Liquiditätsgruppe ermittelt wurden. Die Ergebnisreihen sind in der Objektstruktur die \class{Ergebnis}-Instanzen. Die Werte sind in der ArrayCollection \class{values} gespeichert. Sie beziehen sich auf die einzelnen Abschnitte des zugrundeliegenden Laufzeitbandes.

In der ersten Spalte werden die Abschnitte des Laufzeitbandes abgetragen. Diese können zum Beispiel später in einer Visualisierung als X-Achsenbeschriftung verwendet werden. In der Objektstruktur sind das die \instance{Laufzeitbandabschnitt}-Instanzen. In einer Zeile in der Tabellenstruktur sind demnach die Werte aller \class{Ergebnis}-Instanzen für ein Laufzeitbandabschnitt eingetragen.

Über den eigentlichen Werten werden noch die Parameter eingetragen, die als Key-Value-Paar in der \class{Ergebnis}-Instanz vorhanden sind. Sie können bei einer Visualisierung als Beschriftung für eine Ergebnissreihe verwendet werden.

So entsteht die Tabellenstruktur in \vref{tab:zielstruktur}, welche durch den \class{XcelsiusAdapter} in das Tabellenblatt geschrieben wird. Dort können die Daten durch den Nutzer weiterverarbeitet werden.

\section{Implementierung}
\subsection{Flex Sandbox}
Alle Anwendungen, die mit Hilfe von Adobe Flex programmiert sind, unterliegen bestimmten Sicherheitsbeschränkungen. Darunter fällt auch die Erweiterung, die im Rahmen dieser Bachelorarbeit entwickelt wird. Die Ausführung von Flex-Anwendungen erfolgt in einer Sandbox. Dadurch sollen ungewollte Änderungen auf Client-Seite verhindert werden -- die Anwendung darf sich nur ein einem klar definierten Raum bewegen.


Eine dieser Beschränkungen ist die Verhinderung von Cross-Domain Requests. Dabei handelt es sich um einen Aufruf eines Webservice, dessen Ziel eine andere Domain ist. In dem konkreten Beispiel der Erweiterung für \gls{Xcelsius} ist die Domain der lokale Computer (localhost). Es ist nur möglich, Webservices aufzurufen, die der Computer selbst bereitstellt. Das SAP LRM selbst läuft nicht auf dem Computer, sondern auf einem Server in einer eigenen Domain. Dadurch ist das Konsumieren von Daten aus dem SAP LRM zunächst nicht möglich, da es durch die Sandbox blockiert wird. Die Beschränkung ist in \vref{fig:flex_sandbox} dargestellt.

\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=15cm]{images/flex_sandbox.png}
\caption{...\label{fig:flex_sandbox}}
\end{figure} \todo{Titel festelgen}

Für dieses Problem kommen zwei Lösungsansätze in Frage. Zum einen ist es möglich, dass der Anbieter des Webservice explizit festlegen kann, dass der Webservice auch über verschiedene Domains hinweg konsumiert werden kann. Dies geschieht über eine Datei crossdomain.xml, welche in dem Hauptverzeichnis der Domain abgelegt werden muss. Bei der Erweiterung wäre das der Anwendungsserver des SAP LRM. Änderungen an diesem zu veranlassen würde einen hohen Aufwand benötigen. 

Um diesen Aufwand zu umgehen, wurde der zweite Lösungsansatz umgesetzt. Hierbei wird auf dem Client ein lokaler Webserver installiert. Dieser Webserver ist über die Domain localhost erreichbar. Alle Anfragen der Erweiterung gehen gegen den lokalen Webserver. Dadurch, dass die Flex-Anwendung auch unter der Domain localhost ausgeführt wird, ist der Zugriff erlaubt. Der Webserver stellt die Anfrage an den richtigen Webservice im SAP LRM und leitet die Antwort an die Erweiterung weiter.

Für die Umsetzung wurde lokal ein \gls{glos:tomcat}-Webserver installiert. Für diesen wurde ein einfaches Java-HttpServlet entwickelt, welches die geforderte Funktionalität umsetzt. Der Quelltext des Servlets ist in \vref{listing:servlet} zu sehen.

Für die Zukunft sollte allerdings versucht werden, die Lösung über die crossdomain.xml-Datei umzusetzen. Dadurch entfällt der zusätzlich notwendige lokale Webserver.

\subsection{Asynchroner Programmablauf}
\label{sec:asynchron}
Im Vergleich zu dem Entwurf und der Analyse, bei dem alle Aufrufe synchron durchgeführt wurden, wird dies aus zwei Gründen in der Umsetzung auf hauptsächlich asynchrone Aufrufe umgestellt. Dabei handelt es sich um folgende Gründe:

Auf der einen Seite kann sich dadurch ein Geschwindigkeitsvorteil ergeben. Falls sich bei der Orchestrierung die Antwort eines Aufruf eines Webservice verzögert, können trotzdem alle anderen Anfragen schon verarbeitet werden. Der dadurch gewonnene Vorteil ist aufgrund technischer Limitierungen leider nicht allzu groß, da die Anwendung später nur auf einem Thread ausgeführt wird und somit eine echt parallele Verarbeitung von zwei simultan erhaltenen Antworten nicht möglich ist. \todo{Erklärung, warum nur ein Thread?!}

Auf der anderen Seite wird für den Aufruf der Webservices in der Klasse \class{WebServiceConnector} die Flex-Klasse \class{HTTPService} verwendet. Diese bietet nur die Möglichkeit über EventListener auf zwei Events, nämlich dem erfolgreichen Aufruf des Webservice und dem fehlgeschlagen Aufruf zu reagieren. Dabei werden zwei Callback-Methoden angegeben, die dann asynchron aufgerufen werden. Ab diesem Zeitpunkt endet somit der bis dahin ausschließlich synchrone Aufruf. Der entsprechende Quelltext ist in \vref{listing:ws_aufruf} dargestellt.

\begin{programm}[h] % aus WebserviceConnector
\begin{lstlisting}[language=ActionScript]
public function consume():void{
	// HTTPService-Instanz erstellen
	webService = new HTTPService();
	webService.url = serviceURL;       
	webService.method = "GET";
	// Event Listener hinzufuegen
	webService.addEventListener(ResultEvent.RESULT,onHttpRequestSuccess);
	webService.addEventListener(FaultEvent.FAULT,onHttpRequestFailure);
	// Anfrage senden
	webService.send();
}
		
public function onHttpRequestSuccess(event:ResultEvent){
	// Asynchroner Aufruf bei Erfolg
	// ...
}
		
public function onHttpRequestFailure(event:FaultEvent){
	//Asynchroner Aufruf bei Fehlschlag
	// ...
}
\end{lstlisting}
\caption{Aufruf eines Webservice in der Erweiterung\label{listing:ws_aufruf}}
\end{programm}

Durch die Asynchronität ändert sich entsprechend die Signatur der Methoden. Der Rückgabewert entfällt, stattdessen wird ein zusätzlicher Parameter mitgegeben. Bei \gls{glos:actionscript} kann dies entweder eine Methode eines Objektes sein, siehe dazu \vref{listing:ws_aufruf}. Alternativ kann auch eine Objekt-Instanz übergeben werden. Auf dieser Instanz wird dann zu dem entsprechenden Zeitpunkt eine festgelegte Methode aufgerufen.

Anfang und Ende eines Aufrufes von einem Webservice über den \class{ObjectProvider} und den \class{Deserializer} ist der \class{Orchestrator}. Dieser startet die Aufrufe in der Methode \method{getKPI()} oder \method{getFundingMatrix()} und erhält die Antworten durch die Asynchronität in beliebiger Reihenfolge in der Methode \method{onObjectProviderSuccess()}. Um die Aufrufe unterscheiden und identifizieren zu können, wird bei dem Aufruf ein \class{RequestToken} mitgegeben. Dieser wird weitergereicht und schließlich auch der Methode \method{onObjectProviderSuccess()} als Parameter zurückgegeben.

Um festzustellen, ob alle Anfragen erfolgreich zurückgekommen sind und somit mit der finalen Orchestrierung begonnen werden kann, werden die \class{RequestToken} in einer internen Liste verwaltet. Diese Liste enthält alle Anfragen, von denen die Antwort noch aussteht.  Wird die Antwort erhalten, wird der Token aus der Liste entfernt, in einen \class{ResultToken} umgewandelt, indem das eigentliche Ergebnis angehängt wird, und in einer weiteren Liste zwischengespeichert. Wurden alle Anfragen erfolgreich beantwortet, kann die Orchestrierung durchgeführt werden. Die einzelnen Ergebnisse können dann aus der Liste mit den \class{ResultToken}-Instanzen bezogen werden.

Die Methode \method{onObjectProviderSuccess()} wird asynchron aufgerufen und verändert unter anderem die beiden Listen zur Verwaltung der Token. Demnach handelt es sich hierbei normalerweise um einen kritischen Abschnitt, in dem kritische Daten verändert werden. Der Zugriff auf diese Methode müsste synchronisiert werden. Da aber die Anwendung später auf nur einem Thread ausgeführt wird, kann auf eine Synchronisation verzichtet werden. \todo{ TODO Warum? Erklären!}

In \vref{listing:orchestrierung:webservices} ist in allgemeiner Form der erläuterte Ablauf implementiert. Dabei werden zwei beliebige \class{ObjectProvider} abgefragt. Die jeweiligen Ergebnisse können dann in gewünschter Weise orchestriert werden. Die in dem Beispiel verwendeten Klassen wurden teilweise vereinfacht und entsprechen nicht den Klassen in dem statischen Modell der Erweiterung.

\begin{programm}[h] % aus WebServiceConnector
\begin{lstlisting}[language=ActionScript]
private function orchestrateWebServices():void{
	// Verwaltung der Token
	pendingRequestToken = new ArrayCollection();
	finishedRequestToken = new ArrayCollection();
	
	// Beispielhafte Anfrage an ein ObjectProvider
	var objectProviderA:ObjectProvider = new ObjectProvider();
	var token:RequestToken = new RequestToken(RequestToken.REQUEST_A);
	pendingRequestToken.addItem(token);
	objectProvider.getObject(token,this);
	
	// beliebige weitere Anfragen an ObjectProvider ...
}
// Callback-Methode fuer die ObjectProvider
public function onObjectProviderSuccess(result:Object, token:RequestToken):void{
	// Ergebnis der Anfrage vermerken
	pendingRequestToken.removeItemAt(pendingRequestToken.getItemIndex(token));
	finishedRequestToken.addItem(new ResultToken(token,result));
	
	if(pendingRequestToken.length == 0){ // alle Ergebnisse liegen vor
		// Zugriff auf Ergebnisse
		var ergA:Object = getResultForRequest(RequestToken.REQUEST_A);
		// Ergebnisse Orchestrieren ...
	}
}
// Hilfsmethode fuer den Zugriff auf ein Resultat	
private function getResultForRequest(request:String):Object{
	for each(var token:ResultToken in finishedRequestToken){
		if(token.attribute == request)
			return token.result;
	}
	throw "no result";
}
\end{lstlisting}
\caption{Beispielhafter Ablauf der Orchestrierung von Webservices\label{listing:orchestrierung:webservices}}
\end{programm}

\subsection{Webservice-Ablauf}
In diesem Abschnitt soll an dem Beispiel des Finanzierungsmatrix-Webservice exemplarisch gezeigt werden, wie der Aufruf und die Umwandlung in ein internes Objektformat realisiert wird.

\todo{ist url evtl uri ?!}
Der Ausgangspunkt ist dazu der \class{Orchestrator}, der die \method{getObject}-Methode des \class{FundingMatrixObjectProviders} aufruft. Zunächst wird hier die passende \gls{url} für den Webservice-Aufruf auf Grundlage der Einstellungen generiert. In diesem Fall werden über die \gls{url} die Parameter Liquiditätsgruppen, Liquiditätsszenarien, Laufzeitband und Zielwährung übergeben. Es wird eine \class{WebserviceConnector}-Instanz erzeugt und über die \method{consume()}-Methode des \class{WebserviceConnectors} der eigentliche Aufruf gestartet. Entsprechend dem asynchronen Programmablauf, siehe dazu \vref{sec:asynchron}, wird die eigene Instanz als Callback und der \class{RequestToken} mitgegeben.

Tritt bei dem Aufruf ein Fehler auf, wird asynchron die Methode \method{onWebServiceFail()} aufgerufen. Der Fehler muss nur dem \class{Orchestrator} weitergeleitet werden. Dazu wurde auch hier bei dem \method{getObject}-Aufruf eine Referenz auf den \class{Orchestrator} als Callback mitgegeben.

Wenn kein Fehler auftritt, wird statt der Methode zur Behandlung des Fehlers die \method{onWebServiceSuccess()}-Methode aufgerufen. Der Parameter \class{ResultEvent} enthält die Antwort des Webservice als Zeichenkette. Diese muss nun in die interne Objektstruktur umgewandelt werden. Dazu wird der \class{FundingMatrixObjectDeserializer}  verwendet. Die \gls{XML}-Eingabe für den \class{Deserializer} und die daraus generierte Objektstruktur ist in \vref{fig:umwandlung:ueberblick} dargestellt.

\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=15cm]{images/umwandlung.png}
\caption{Umwandlung der XML-Antwort in die interne Objektstruktur\label{fig:umwandlung:ueberblick}}
\end{figure}

Bei der Deserialisierung kann wiederum auf Hilfsklassen von Flex zugegriffen werden. Über die Klasse \class{SimpleXMLDecoder} kann einfach ein Proxy-Objekt erzeugt werden. Dadurch kann auf die einzelnen Elemente in der \gls{XML}-Struktur wie auf Attribute eines Objektes zugegriffen werden. Der Quellcode, der Umwandlung, wie sie in \vref{fig:umwandlung:ueberblick} dargestellt ist, zeigt, findet sich in \vref{listing:deserialisierung}.
\todo{satz kürzen}

\begin{programm}[h] % aus WebServiceConnector
\begin{lstlisting}[language=ActionScript]
public override function deserialize(content:String):Object{			
	var decoder:SimpleXMLDecoder = new SimpleXMLDecoder();
	var proxyObject:Object = decoder.decodeXML(new XMLDocument(content));
	
	var result:ArrayCollection = new ArrayCollection();
	var resultGroup:Result = null;			
			
	for each(var entry:Object in proxyObject.feed.entry as Array){
		var liquiGroup:String = entry.content.properties.CLIQUI_GRP_ID as String;
		var liquiScenario:String = entry.content.properties.CLIQUI_SCENARIO as String;
		if(resultGroup == null || resultGroup.getParameter(Result.LIQUIDITY_GROUP) != liquiGroup || resultGroup.getParameter(Result.LIQUIDITY_SCENARIO) != liquiScenario){
			if(resultGroup != null) // dont add null at first time
				result.addItem(resultGroup);
			resultGroup = new Result();
			resultGroup.addParameter(new KeyValue(Result.LIQUIDITY_GROUP,liquiGroup));
			resultGroup.addParameter(new KeyValue(Result.LIQUIDITY_SCENARIO,liquiScenario));
		}
		var value:Number = entry.content.properties.KCTARGET_AMOUNT as Number;
		resultGroup.addValue(value);
	}
	result.addItem(resultGroup);
	return result;
}
\end{lstlisting}
\caption{Deserialisierung des XML-Format in die interne Objektstruktur\label{listing:deserialisierung}}
\end{programm}

Die \class{ObjectProvider} und \class{Deserializer} für die weiteren Webservices sind analog dazu programmiert. Bei einem \class{CachedObjectProvider} wird in der \method{getObject}-Methode zunächst ermittelt, ob sich das angeforderte Objekt schon im Cache befindet und dann direkt zurückgegeben. Ist es noch nicht vorhanden, wird der Webservice-Aufruf gestartet und nach der Deserialisierung wird das Objekt im Cache für weitere Anfragen gehalten.

\subsection{\gls{Xcelsius} Binding}
\label{sec:xcelsius_binding}
Für den Datenaustausch zwischen der entwickelten Erweiterung und dem Tabellenblatt von \gls{Xcelsius} muss auf die bereitgestellten Funktionen des \gls{Xcelsius} \gls{glos:sdk} zurückgegriffen werden. Dabei wird das Konzept des Bindings genutzt.

Bei diesem Konzept wird ein Attribut einer Instanz fest mit einem Zellenbereich auf dem Tabellenblatt verbunden. Dabei kann es sich entweder um ein flaches Attribut, wie zum Beispiel eine Zeichenkette oder eine Zahl, handeln, die dann mit einer einzelnen Zelle auf dem Tabellenblatt verbunden wird. Es kann allerdings auch auf Tabellenblatt-Seite ein Bereich festgelegt werden, der dann zum Beispiel mit einem zweidimensionalen Array verbunden wird.

Für solch eine Verbindung muss zusätzlich noch eine Richtung festgelegt werden. Das \gls{Xcelsius} \gls{glos:sdk} bietet dabei drei Möglichkeiten an:

\begin{seToplist}{ XXX }

\item[1.] \textbf{Input-Binding} \newline
Bei einem Input-Binding findet der Datenfluss nur von dem Tabellenblatt zu der Erweiterung statt. Er dient damit ausschließlich dafür, auf das Tabellenblatt lesend zuzugreifen. Sobald sich der Wert im Tabellenblatt ändert, wird diese Änderung auf das Attribut übertragen.

\item[2.] \textbf{Output-Binding} \newline
Das Output-Binding bietet ausschließlich schreibenden Zugriff auf das Tabellenblatt. Wird also der Attributswert verändert, wird die dazugehörige Zelle oder Zellbereich entsprechend angepasst. Der Datenfluss findet nur von der Erweiterung zu dem Tabellenblatt statt.

\item[3.] \textbf{Input-Output-Binding} \newline
Bei dieser Verbindungsart findet zwischen dem Tabellenblatt ein beidseitiger Austausch statt. Von beiden Seiten her werden Veränderungen auf die jeweils andere Seite übertragen. Der Wert der Zelle wird mit dem Attributswert synchronisiert.

\end{seToplist}

Für die Umsetzung der Erweiterung spielen Input-Output-Bindings keine Rolle, es werden nur Input- oder Output-Bindings verwendet. Das Auslesen der gewählten Parameter findet über mehrere Input-Bindings statt. Für das Laufzeitband wird dabei eine Zelle mit dem Attribut \class{selectedMaturityBand} des \class{XcelsiusAdapter} verknüpft. Bei den Liquiditätsszenarien und den Liquiditätsgruppen können jeweils mehrere Ausgewählt werden. Hier bezieht sich das Binding demnach nicht auf eine einzelne Zelle, sondern auf einen Zellbereich.

\todo{Bereitstellung der Werteholfen hinzufügen}

\section{Zusammenfassung}
\loreIpsum

\chapter{Evaluation} \todo{Evaluation der ...}



\section{Einleitung}
\loreIpsum

\section{Neue Möglichkeiten}
Durch die Erweiterung ist es nun möglich, \gls{Xcelsius} in Verbindung mit den Daten des SAP LRM zu nutzen. Dazu muss zu einem Dashboard lediglich eine neue Verbindung, die Teil der Erweiterung ist, hinzugefügt werden.

Für diese Verbindung müssen in den Einstellugnen dann einige erforderliche Bindings, siehe dazu \vref{sec:xcelsius_binding}, festgelegt werden. Der Dialog zum festlegen der Einstellungen ist  \vref{fig:einstellung} zu sehen. Erforderlich sind hierbei der Nutzer mit entsprechendem Passwort für die Authentifizierung, und die \gls{url}, unter der das SAP LRM erreichbar ist.

\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=10cm]{images/xcelsius_einstellungen.PNG}
\caption{...\label{fig:einstellung}}
\end{figure} \todo{Titel finden}

Für die Finanzierungsmatrix müssen für alle erforderlichen Parameter für die Berechnungskomponente (vgl. \vref{sec:berechnungskomponente:parameter}) und ein Bereich, in den das Ergebnis geschrieben wird, mit Bindings verbunden werden.

Da die Kennzahlenanalyse keine Parameter erfordert, reicht hier ein Binding für das Ergebnis. Die Wertehilfen, die zusätzlich angeboten werden, können genutzt werden, sind aber nicht zwingend erforderlich. Wenn der Nutzer sich dafür entscheidet, sie zu nutzen, muss entsprechend für jede Hilfe auch ein Binding erzeugt werden.

In dem erstellten Beispieldashboard wurden alle zur Verfügung stehenden Funktionalitäten ausgenutzt. Die Finanzierungsmatrix wurde als Liniendiagramm dargestellt. Die erforderlichen Parameter werden durch die Kombinationsfelder auf der linken Seite festgelegt. Die Auswahlmöglichkeiten beruhen dabei auf der angebotenen Wertehilfe. 

An dieser Stelle wären durchaus auch noch andere Möglichkeiten denkbar, zum Beispiel über Checkboxen oder ähnlichen Auswahlelementen. Dies zeigt, dass die Erweiterung hier keinerlei Beschränkungen vorgibt. Die Form des Parameter-Inputs und der Verarbeitung der Ergebnisse ist komplett offen gehalten und nur durch die Möglichkeiten von Xcelsius beschränkt.

Die Kennzahlenanalyse, die in der ursprünglichen Situation, wie in \vref{fig:lrm_istzustand_keyfigureanalysis} zu sehen, nur als einfache Tabelle dargestellt wurden, kann nun beliebig visualisiert werden. In dem Beispiel zeigt sich dies durch die Tachodarstellung.


\section{Erfüllung der Anforderungen}
An die Erweiterung wurden in der Spezifikation in \vref{sec:anforderungen} einige funktionale und nicht-funktionale Anforderungen gestellt. Um diese zu überprüfen wurde ein Beispieldashboard, das in \vref{fig:umsetzung_dashboard} zu sehen ist, erstellt.

\begin{figure}[h]
\centering
\setlength{\unitlength}{1mm}
\includegraphics[width=15cm]{images/dashboard_preview.PNG}
\caption{...\label{fig:umsetzung_dashboard}}
\end{figure} \todo{Titel finden}

Es ist einfach zu erkennen, dass beide funktionalen Anforderungen mit der Erweiterung erfüllt werden können. Sowohl die Daten für die Kennzahlen, als auch die Daten für die Finanzierungsmatrix stehen zur Verfügung. In dem Beispiel ist eine Kennzahl mit dem Tachometer (unten) visualisiert, die Finanzierungsmatrix im oberen Teil als Liniendiagramm.

%\item[\anfl{uebertragbarkeit}] \textbf{Übertragbarkeit} \newline
%Im Rahmen der Bachelorarbeit wird exemplarisch die Anbindung einer weiteren Anwendung zur Auswertung an das SAP LRM implementiert werden. Das Konzept der Umsetzung soll dennoch auf weitere Anwendungen übertragen werden können.
Die \anfRef{anf:uebertragbarkeit}{an die Übertragbarkeit } wird dadurch gewährleistet, dass die komplette Analyse programmiersprachenunabhängig durchgeführt wurde. Sie kann mit jeder objektorientierten Programmiersprache umgesetzt werden - es müsste nur die Schnittstelle zu der eigentlichen Anwendung, also der XcelsiusAdapter, entsprechend angepasst werden.


%\item[\anfl{erweiterbarkeit}] \textbf{Erweiterbarkeit} \newline
%Das SAP LRM befindet sich aktuell noch in einer ersten Version in Entwicklung. Weitere Versionen sind schon jetzt in Planung. Zusätzliche Funktionen und Möglichkeiten, die in einer Weiterentwicklungen des SAP LRM eingeführt werden, sollen mit möglichst geringem Aufwand auch auf die Erweiterung übertragen werden können.

%\item[\anfl{wartbarkeit}] \textbf{Wartbarkeit} \newline
%Um die Folgekosten der Erweiterung, zum Beispiel im Hinblick auf die Beseitigung von Fehlern, möglichst gering zu halten, soll eine gute Wartbarkeit von Anfang an bei der Entwicklung beachtet werden.
Durch den modularen Aufbau mit den verschiedenen ObjectProvidern können neue Funktionalitäten durch die Erstellung von weiteren ObjectProvider-Implementierungen leicht umgesetzt werden. Somit kann auch \anfRef{anf:erweiterbarkeit}{} als erfüllt betrachtet werden. Gleichzeitig wird dadurch die \anfRef{anf:erweiterbarkeit}{an die Wartbarkeit } abgedeckt.

%\item[\anfl{korrektheit}] \textbf{Korrektheit der Ergebnisse} \newline
%Die Daten, die mit Hilfe der Erweiterung in zusätzlichen Anwendungen verfügbar gemacht werden, müssen mit den Ergebnissen des SAP LRM übereinstimmen. Nur wenn das sichergestellt ist, kann die Erweiterung sinnvoll genutzt werden.
Die Korrektheit der Ergebnisse, siehe \anfRef{anf:korrektheit}{}, wird dadurch sichergestellt, dass die Berechnungskomponente des SAP LRM über die selbe Schnittstelle aufgerufen wird, wie es auch die Benutzeroberfläche in Oberon macht. Somit stimmen die Ergebnisse überein.

%\item[\anfl{sicherheit}] \textbf{Sicherheitsanforderungen} \newline
%Die Erweiterungen wird Zugang zu den Daten des SAP LRM bieten. Es handelt sich dabei um vertrauliche Daten, die  Zugangsbeschränkungen unterliegen. Es muss sichergestellt sein, dass die Zugangsbeschränkungen eingehalten werden und Daten nicht von unberechtigten Personen ausgelesen werden können.
Der Zugang zu den Daten ist, genau wie bei der existierenden iPad-Anwendung, durch Nutzer und Password vor unberechtigtem Zugriff geschützt. Dabei wird die gleiche Authentifizierungsmethode verwendet. Für potentielle Angreifer ist somit der Aufwand für unberechtigten Zugriff nicht geringer geworden -- \anfRef{anf:sicherheit}{} ist abgedeckt.

%\item[\anfl{leistung}] \textbf{Leistung} \newline
%Ein wichtiges Unterscheidungsmerkmal des SAP LRM durch die Nutzung von \gls{HANA} ist die schnelle Analyse von Daten. Die Erweiterung soll die Geschwindigkeitsvorteile von \gls{HANA} auch in anderen Anwendungen verfügbar machen.
Schließlich bleibt noch \anfRef{anf:leistung}{}. Die Leistung aus der Sicht des Nutzers setzt aus der Zeit für die Berechnung der Werte durch die Berechnungskomponente und der eigentlichen Darstellung zusammen. Die Zeit für die Berechnung ist dabei festgesetzt und kann nicht beeinflusst werden. Die Zeit zur Darstellung ist dabei in Xcelsius mit der Erweiterung sogar schneller, als die Darstellung mit dem Oberon-Framework. Ein Hauptgrund ist hierbei das vergleichsweise langsame Rendern des Diagramms durch Oberon. Durch eine echt-parallele Verarbeitung der Webservice-Aufrufe könnte die Leistung der Erweiterung sogar noch gesteigert werden. Auch diese Anforderung ist somit erfüllt, obwohl sie bei der Entwicklung nicht im Mittelpunkt stand.

\section{Zusammenfassung}
\loreIpsum

\chapter{Zusammenfassung}
\loreIpsum

\loreIpsum

\loreIpsum

\loreIpsum

\end{onehalfspacing}


% -------------------------------------------------------------------------------------
% Anhang der Arbeit
% -------------------------------------------------------------------------------------
\seAppendix{}

\pagenumbering{Roman}
\setcounter{page}{8}

\chapter{Anhang}

\begin{programm}[h] % aus WebServiceConnector
\begin{lstlisting}[language=Java]
import java.io.*;
import java.net.*;
import javax.servlet.http.*;
import javax.servlet.*;

@SuppressWarnings("serial")
public class ProxyServlet extends HttpServlet {

	public void doGet (HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException {
		// build request url
		String requestedUrl = req.getServletPath();
		String params = req.getQueryString();
		String urlString = "http://ldciqhc.wdf.sap.corp:50000"+requestedUrl;
		if(params != null)
			urlString += "?"+params;
		
		// build connection
		URL url = new URL(urlString);
		HttpURLConnection conn  = (HttpURLConnection) url.openConnection();
		
		// set password
		String encoding = new sun.misc.BASE64Encoder().encode("username:pw".getBytes());
		conn.setRequestProperty ("Authorization", "Basic " + encoding);
		
		// start request
		conn.setRequestMethod("GET");
		conn.connect();
		
		// get response
		PrintWriter out = res.getWriter();
		BufferedReader reader = new BufferedReader(new InputStreamReader(conn.getInputStream()));
		String content = null;
		while((content = reader.readLine()) != null){
			out.print(content);
		}
		out.flush();
		out.close();
	}
}
\end{lstlisting}
\caption{Proxy-Servlet zur Umgehung der Cross-Domin Request Beschränkungen\label{listing:servlet}}
\end{programm}

% -------------------------------------------------------------------------------------
%  Erzeugung eines Glossars
% -------------------------------------------------------------------------------------
\newpage
\sePrintGlossary{}

% -------------------------------------------------------------------------------------
% Literaturverzeichnisses
% -------------------------------------------------------------------------------------
\sePrintBibliography{}


% Sammelwerke, die in der Grundform vorkommen sollten!
%\nocite{Bar.08}
%\nocite{Rom.10}
%\nocite{Zer.10}
%\nocite{Hof.11}
%\nocite{Eve.08}

\bibliographystyle{sty/bibliothek-style}
\seBibliography{literatur}

% -------------------------------------------------------------------------------------
% Erzeugung der ehrenw\"ortlichen Erkl\"arung
% -------------------------------------------------------------------------------------
\seEhrenwoertlicheErklaerung{}

\end{document}
